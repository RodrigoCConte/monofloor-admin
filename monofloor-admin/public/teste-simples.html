<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TESTE ISOLADO - Calculadora</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      background: #000;
      color: #fff;
    }
    h1 { margin-bottom: 30px; color: #c9a962; }
    .campo {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      color: #999;
    }
    input, select {
      width: 100%;
      max-width: 400px;
      padding: 12px;
      font-size: 16px;
      background: #222;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
    }
    .resultado {
      margin-top: 40px;
      padding: 30px;
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 8px;
      max-width: 500px;
    }
    .resultado h2 {
      color: #c9a962;
      margin-bottom: 20px;
    }
    .linha {
      padding: 10px 0;
      border-bottom: 1px solid #333;
      display: flex;
      justify-content: space-between;
    }
    .linha:last-child {
      border-bottom: none;
      font-weight: bold;
      font-size: 18px;
      color: #c9a962;
    }
    .console {
      margin-top: 30px;
      padding: 20px;
      background: #0a0a0a;
      border: 1px solid #333;
      border-radius: 4px;
      max-width: 800px;
      font-family: monospace;
      font-size: 12px;
      color: #0f0;
      max-height: 400px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>üß™ TESTE ISOLADO - Calculadora de Prazos</h1>
  <p style="color: #666; margin-bottom: 20px;">Digite nos campos abaixo. Deve atualizar INSTANTANEAMENTE.</p>

  <div class="campo">
    <label>Metragem Total (m¬≤)</label>
    <input type="number" id="metros" value="100" min="1">
  </div>

  <div class="campo">
    <label>N√∫mero de Prestadores (deixe vazio para sugest√£o autom√°tica)</label>
    <input type="number" id="prestadores" value="" placeholder="Auto" min="1">
  </div>

  <div class="campo">
    <label>Tipo de Obra</label>
    <select id="tipo">
      <option value="piso">ü™® Apenas Piso</option>
      <option value="misto">üß± Piso + Paredes (30% menos produtivo)</option>
    </select>
  </div>

  <div class="resultado">
    <h2>üìä Resultado</h2>
    <div class="linha">
      <span>Produ√ß√£o di√°ria da equipe</span>
      <span id="producao">-</span>
    </div>
    <div class="linha">
      <span>Dias de instala√ß√£o</span>
      <span id="diasInst">-</span>
    </div>
    <div class="linha">
      <span>Dias de cura</span>
      <span>2 dias</span>
    </div>
    <div class="linha">
      <span>PRAZO TOTAL ESTIMADO</span>
      <span id="total">-</span>
    </div>
  </div>

  <div class="console">
    <h3 style="color: #fff; margin-bottom: 10px;">Console de Debug:</h3>
    <pre id="log"></pre>
  </div>

  <script>
    console.log('üöÄ Script carregando...');

    // Fun√ß√£o de log
    function log(msg) {
      const el = document.getElementById('log');
      el.textContent += msg + '\n';
      console.log(msg);
    }

    log('‚úÖ Fun√ß√µes de log definidas');

    // Tabela de produtividade REAL
    const tabela = [
      { area: 50, prestadores: 2, dias: 5, m2PorHomemDia: 5.0 },
      { area: 80, prestadores: 2, dias: 5, m2PorHomemDia: 8.0 },
      { area: 150, prestadores: 3, dias: 8, m2PorHomemDia: 6.25 },
      { area: 200, prestadores: 3, dias: 8, m2PorHomemDia: 8.33 },
      { area: 250, prestadores: 4, dias: 10, m2PorHomemDia: 6.25 },
      { area: 300, prestadores: 4, dias: 12, m2PorHomemDia: 6.25 },
      { area: 350, prestadores: 4, dias: 12, m2PorHomemDia: 7.29 },
      { area: 400, prestadores: 5, dias: 11, m2PorHomemDia: 7.27 },
      { area: 500, prestadores: 5, dias: 12, m2PorHomemDia: 8.33 },
      { area: 600, prestadores: 6, dias: 12, m2PorHomemDia: 8.33 },
      { area: 700, prestadores: 6, dias: 16, m2PorHomemDia: 7.29 },
      { area: 800, prestadores: 7, dias: 17, m2PorHomemDia: 6.72 },
      { area: 900, prestadores: 8, dias: 18, m2PorHomemDia: 6.25 },
      { area: 1000, prestadores: 9, dias: 20, m2PorHomemDia: 5.56 },
      { area: 1200, prestadores: 12, dias: 20, m2PorHomemDia: 5.0 },
    ];

    const DIAS_CURA = 2;
    const REDUCAO_PAREDE = 0.70;

    log('‚úÖ Constantes definidas');

    // Buscar janela (valor mais pr√≥ximo)
    function buscarJanela(area) {
      log('üîç Buscando janela para ' + area + 'm¬≤...');

      // Valor exato?
      const exato = tabela.find(d => d.area === area);
      if (exato) {
        log('   ‚úÖ Valor EXATO: ' + exato.area + 'm¬≤');
        return exato;
      }

      // Menor que 50?
      if (area < 50) {
        log('   ‚ö†Ô∏è Menor que 50m¬≤ - usando 50m¬≤');
        return tabela[0];
      }

      // Maior que 1200?
      if (area > 1200) {
        log('   ‚ö†Ô∏è Maior que 1200m¬≤ - usando 1200m¬≤');
        return tabela[tabela.length - 1];
      }

      // Achar o mais pr√≥ximo
      let maisProximo = tabela[0];
      let menorDif = Math.abs(area - tabela[0].area);

      for (let i = 1; i < tabela.length; i++) {
        const dif = Math.abs(area - tabela[i].area);
        if (dif < menorDif) {
          menorDif = dif;
          maisProximo = tabela[i];
        }
      }

      log('   ‚úÖ Mais pr√≥ximo: ' + maisProximo.area + 'm¬≤');
      return maisProximo;
    }

    log('‚úÖ Fun√ß√£o buscarJanela() definida');

    // Calcular prazo
    function calcular() {
      log('\nüìä === CALCULANDO ===');

      const m2 = parseFloat(document.getElementById('metros').value) || 0;
      let prest = parseInt(document.getElementById('prestadores').value);
      const tipo = document.getElementById('tipo').value;
      const ehParede = (tipo === 'misto');

      log('   Metragem: ' + m2 + 'm¬≤');
      log('   Prestadores: ' + (prest || 'Auto'));
      log('   Tipo: ' + tipo);

      if (m2 <= 0) {
        log('   ‚ö†Ô∏è Metragem inv√°lida!');
        document.getElementById('producao').textContent = '-';
        document.getElementById('diasInst').textContent = '-';
        document.getElementById('total').textContent = '-';
        return;
      }

      // Buscar janela
      const janela = buscarJanela(m2);

      // Auto-sugerir time
      if (!prest || prest <= 0) {
        prest = janela.prestadores;
        document.getElementById('prestadores').value = prest;
        log('   üí° Auto-sugest√£o: ' + prest + ' prestadores');
      }

      // Calcular produ√ß√£o
      let prod = janela.m2PorHomemDia * prest;
      log('   üìà Produ√ß√£o base: ' + prod.toFixed(1) + ' m¬≤/dia');

      // Redu√ß√£o de parede?
      if (ehParede) {
        prod = prod * REDUCAO_PAREDE;
        log('   üìâ Com redu√ß√£o (70%): ' + prod.toFixed(1) + ' m¬≤/dia');
      }

      // Calcular dias
      const diasInst = Math.ceil(m2 / prod);
      const total = diasInst + DIAS_CURA;

      log('   ‚è±Ô∏è Dias instala√ß√£o: ' + diasInst);
      log('   ‚è±Ô∏è Dias cura: ' + DIAS_CURA);
      log('   üéØ TOTAL: ' + total + ' dias');

      // Atualizar interface
      document.getElementById('producao').textContent = prod.toFixed(1) + ' m¬≤/dia';
      document.getElementById('diasInst').textContent = diasInst + ' dias';
      document.getElementById('total').textContent = total + ' dias';

      log('   ‚úÖ Interface atualizada!\n');
    }

    log('‚úÖ Fun√ß√£o calcular() definida');

    // Esperar DOM carregar
    document.addEventListener('DOMContentLoaded', function() {
      log('\nüé¨ DOM CARREGADO!');

      // Adicionar eventos
      document.getElementById('metros').addEventListener('input', calcular);
      document.getElementById('prestadores').addEventListener('input', calcular);
      document.getElementById('tipo').addEventListener('change', calcular);

      log('‚úÖ Eventos adicionados aos campos');
      log('üöÄ Pronto! Digite nos campos acima.\n');

      // Calcular inicial
      calcular();
    });

    log('‚úÖ Script configurado - aguardando DOM...');
  </script>
</body>
</html>
