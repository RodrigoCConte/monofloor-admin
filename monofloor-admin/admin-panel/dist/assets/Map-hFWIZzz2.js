import{r as y,d as Cs,u as Es,D as Ie,E as As,h as Ts,i as Ss,c as g,b as E,a as o,j as U,k as q,l as Os,f as X,t as k,m as A,n as M,p as It,e as Te,v as $e,F as ut,q as ht,L as Ms,z as Bs,g as Rs,M as Ue,o as v,_ as Ls}from"./index-BxA64SRE.js";import{_ as $t}from"./logo-CxXS7KxG.js";const Ps="/grupo.png",ee=Object.create(null);ee.open="0";ee.close="1";ee.ping="2";ee.pong="3";ee.message="4";ee.upgrade="5";ee.noop="6";const Ve=Object.create(null);Object.keys(ee).forEach(n=>{Ve[ee[n]]=n});const gt={type:"error",data:"parser error"},jt=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ht=typeof ArrayBuffer=="function",Wt=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,kt=({type:n,data:e},t,s)=>jt&&e instanceof Blob?t?s(e):Ut(e,s):Ht&&(e instanceof ArrayBuffer||Wt(e))?t?s(e):Ut(new Blob([e]),s):s(ee[n]+(e||"")),Ut=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function qt(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let dt;function Ds(n,e){if(jt&&n.data instanceof Blob)return n.data.arrayBuffer().then(qt).then(e);if(Ht&&(n.data instanceof ArrayBuffer||Wt(n.data)))return e(qt(n.data));kt(n,!1,t=>{dt||(dt=new TextEncoder),e(dt.encode(t))})}const zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<zt.length;n++)Oe[zt.charCodeAt(n)]=n;const Ns=n=>{let e=n.length*.75,t=n.length,s,r=0,d,f,_,b;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const j=new ArrayBuffer(e),z=new Uint8Array(j);for(s=0;s<t;s+=4)d=Oe[n.charCodeAt(s)],f=Oe[n.charCodeAt(s+1)],_=Oe[n.charCodeAt(s+2)],b=Oe[n.charCodeAt(s+3)],z[r++]=d<<2|f>>4,z[r++]=(f&15)<<4|_>>2,z[r++]=(_&3)<<6|b&63;return j},Is=typeof ArrayBuffer=="function",_t=(n,e)=>{if(typeof n!="string")return{type:"message",data:Kt(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:$s(n.substring(1),e)}:Ve[t]?n.length>1?{type:Ve[t],data:n.substring(1)}:{type:Ve[t]}:gt},$s=(n,e)=>{if(Is){const t=Ns(n);return Kt(t,e)}else return{base64:!0,data:n}},Kt=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Yt="",Us=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((d,f)=>{kt(d,!1,_=>{s[f]=_,++r===t&&e(s.join(Yt))})})},qs=(n,e)=>{const t=n.split(Yt),s=[];for(let r=0;r<t.length;r++){const d=_t(t[r],e);if(s.push(d),d.type==="error")break}return s};function zs(){return new TransformStream({transform(n,e){Ds(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const d=new DataView(r.buffer);d.setUint8(0,126),d.setUint16(1,s)}else{r=new Uint8Array(9);const d=new DataView(r.buffer);d.setUint8(0,127),d.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let pt;function qe(n){return n.reduce((e,t)=>e+t.length,0)}function ze(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function Vs(n,e){pt||(pt=new TextDecoder);const t=[];let s=0,r=-1,d=!1;return new TransformStream({transform(f,_){for(t.push(f);;){if(s===0){if(qe(t)<1)break;const b=ze(t,1);d=(b[0]&128)===128,r=b[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(qe(t)<2)break;const b=ze(t,2);r=new DataView(b.buffer,b.byteOffset,b.length).getUint16(0),s=3}else if(s===2){if(qe(t)<8)break;const b=ze(t,8),j=new DataView(b.buffer,b.byteOffset,b.length),z=j.getUint32(0);if(z>Math.pow(2,21)-1){_.enqueue(gt);break}r=z*Math.pow(2,32)+j.getUint32(4),s=3}else{if(qe(t)<r)break;const b=ze(t,r);_.enqueue(_t(d?b:pt.decode(b),e)),s=0}if(r===0||r>n){_.enqueue(gt);break}}}})}const Xt=4;function N(n){if(n)return Fs(n)}function Fs(n){for(var e in N.prototype)n[e]=N.prototype[e];return n}N.prototype.on=N.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};N.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};N.prototype.off=N.prototype.removeListener=N.prototype.removeAllListeners=N.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};N.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};N.prototype.emitReserved=N.prototype.emit;N.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};N.prototype.hasListeners=function(n){return!!this.listeners(n).length};const We=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),W=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),js="arraybuffer";function Jt(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const Hs=W.setTimeout,Ws=W.clearTimeout;function Ke(n,e){e.useNativeTimers?(n.setTimeoutFn=Hs.bind(W),n.clearTimeoutFn=Ws.bind(W)):(n.setTimeoutFn=W.setTimeout.bind(W),n.clearTimeoutFn=W.clearTimeout.bind(W))}const Ks=1.33;function Ys(n){return typeof n=="string"?Xs(n):Math.ceil((n.byteLength||n.size)*Ks)}function Xs(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function Gt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Js(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function Gs(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let d=t[s].split("=");e[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return e}class Qs extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class xt extends N{constructor(e){super(),this.writable=!1,Ke(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new Qs(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=_t(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Js(e);return t.length?"?"+t:""}}class Zs extends xt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};qs(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Us(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Gt()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Qt=!1;try{Qt=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const en=Qt;function tn(){}class sn extends Zs{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,d)=>{this.onError("xhr post error",r,d)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}class Z extends N{constructor(e,t,s){super(),this.createRequest=e,Ke(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=Jt(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Z.requestsCount++,Z.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=tn,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Z.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Z.requestsCount=0;Z.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Vt);else if(typeof addEventListener=="function"){const n="onpagehide"in W?"pagehide":"unload";addEventListener(n,Vt,!1)}}function Vt(){for(let n in Z.requests)Z.requests.hasOwnProperty(n)&&Z.requests[n].abort()}const nn=(function(){const n=Zt({xdomain:!1});return n&&n.responseType!==null})();class on extends sn{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=nn&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Z(Zt,this.uri(),e)}}function Zt(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||en))return new XMLHttpRequest}catch{}if(!e)try{return new W[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const es=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class rn extends xt{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=es?{}:Jt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;kt(s,this.supportsBinary,d=>{try{this.doWrite(s,d)}catch{}r&&We(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Gt()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const ft=W.WebSocket||W.MozWebSocket;class an extends rn{createSocket(e,t,s){return es?new ft(e,t,s):t?new ft(e,t):new ft(e)}doWrite(e,t){this.ws.send(t)}}class ln extends xt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Vs(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=zs();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const d=()=>{s.read().then(({done:_,value:b})=>{_||(this.onPacket(b),d())}).catch(_=>{})};d();const f={type:"open"};this.query.sid&&(f.data=`{"sid":"${this.query.sid}"}`),this._writer.write(f).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&We(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const cn={websocket:an,webtransport:ln,polling:on},un=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function vt(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=un.exec(n||""),d={},f=14;for(;f--;)d[hn[f]]=r[f]||"";return t!=-1&&s!=-1&&(d.source=e,d.host=d.host.substring(1,d.host.length-1).replace(/;/g,":"),d.authority=d.authority.replace("[","").replace("]","").replace(/;/g,":"),d.ipv6uri=!0),d.pathNames=dn(d,d.path),d.queryKey=pn(d,d.query),d}function dn(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function pn(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,d){r&&(t[r]=d)}),t}const mt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Fe=[];mt&&addEventListener("offline",()=>{Fe.forEach(n=>n())},!1);class oe extends N{constructor(e,t){if(super(),this.binaryType=js,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=vt(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=vt(t.host).host);Ke(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Gs(this.opts.query)),mt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Fe.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Xt,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&oe.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",oe.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=Ys(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,We(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const d={type:e,data:t,options:s};this.emitReserved("packetCreate",d),this.writeBuffer.push(d),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(oe.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),mt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Fe.indexOf(this._offlineEventListener);s!==-1&&Fe.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}oe.protocol=Xt;class fn extends oe{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;oe.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",R=>{if(!s)if(R.type==="pong"&&R.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;oe.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(z(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const H=new Error("probe error");H.transport=t.name,this.emitReserved("upgradeError",H)}}))};function d(){s||(s=!0,z(),t.close(),t=null)}const f=R=>{const H=new Error("probe error: "+R);H.transport=t.name,d(),this.emitReserved("upgradeError",H)};function _(){f("transport closed")}function b(){f("socket closed")}function j(R){t&&R.name!==t.name&&d()}const z=()=>{t.removeListener("open",r),t.removeListener("error",f),t.removeListener("close",_),this.off("close",b),this.off("upgrading",j)};t.once("open",r),t.once("error",f),t.once("close",_),this.once("close",b),this.once("upgrading",j),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let gn=class extends fn{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>cn[r]).filter(r=>!!r)),super(e,s)}};function vn(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=vt(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const d=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+d+":"+s.port+e,s.href=s.protocol+"://"+d+(t&&t.port===s.port?"":":"+s.port),s}const mn=typeof ArrayBuffer=="function",yn=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,ts=Object.prototype.toString,bn=typeof Blob=="function"||typeof Blob<"u"&&ts.call(Blob)==="[object BlobConstructor]",wn=typeof File=="function"||typeof File<"u"&&ts.call(File)==="[object FileConstructor]";function Ct(n){return mn&&(n instanceof ArrayBuffer||yn(n))||bn&&n instanceof Blob||wn&&n instanceof File}function je(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(je(n[t]))return!0;return!1}if(Ct(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return je(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&je(n[t]))return!0;return!1}function kn(n){const e=[],t=n.data,s=n;return s.data=yt(t,e),s.attachments=e.length,{packet:s,buffers:e}}function yt(n,e){if(!n)return n;if(Ct(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=yt(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=yt(n[s],e));return t}return n}function _n(n,e){return n.data=bt(n.data,e),delete n.attachments,n}function bt(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=bt(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=bt(n[t],e));return n}const xn=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Cn=5;var x;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(x||(x={}));class En{constructor(e){this.replacer=e}encode(e){return(e.type===x.EVENT||e.type===x.ACK)&&je(e)?this.encodeAsBinary({type:e.type===x.EVENT?x.BINARY_EVENT:x.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===x.BINARY_EVENT||e.type===x.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=kn(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function Ft(n){return Object.prototype.toString.call(n)==="[object Object]"}class Et extends N{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===x.BINARY_EVENT;s||t.type===x.BINARY_ACK?(t.type=s?x.EVENT:x.ACK,this.reconstructor=new An(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Ct(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(x[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===x.BINARY_EVENT||s.type===x.BINARY_ACK){const d=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const f=e.substring(d,t);if(f!=Number(f)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(f)}if(e.charAt(t+1)==="/"){const d=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(d,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const d=t+1;for(;++t;){const f=e.charAt(t);if(f==null||Number(f)!=f){--t;break}if(t===e.length)break}s.id=Number(e.substring(d,t+1))}if(e.charAt(++t)){const d=this.tryParse(e.substr(t));if(Et.isPayloadValid(s.type,d))s.data=d;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case x.CONNECT:return Ft(t);case x.DISCONNECT:return t===void 0;case x.CONNECT_ERROR:return typeof t=="string"||Ft(t);case x.EVENT:case x.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&xn.indexOf(t[0])===-1);case x.ACK:case x.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class An{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=_n(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Tn=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Et,Encoder:En,get PacketType(){return x},protocol:Cn},Symbol.toStringTag,{value:"Module"}));function J(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const Sn=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ss extends N{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[J(e,"open",this.onopen.bind(this)),J(e,"packet",this.onpacket.bind(this)),J(e,"error",this.onerror.bind(this)),J(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,d;if(Sn.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const f={type:x.EVENT,data:t};if(f.options={},f.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const z=this.ids++,R=t.pop();this._registerAckCallback(z,R),f.id=z}const _=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,b=this.connected&&!(!((d=this.io.engine)===null||d===void 0)&&d._hasPingExpired());return this.flags.volatile&&!_||(b?(this.notifyOutgoingListeners(f),this.packet(f)):this.sendBuffer.push(f)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const d=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let _=0;_<this.sendBuffer.length;_++)this.sendBuffer[_].id===e&&this.sendBuffer.splice(_,1);t.call(this,new Error("operation has timed out"))},r),f=(..._)=>{this.io.clearTimeoutFn(d),t.apply(this,_)};f.withError=!0,this.acks[e]=f}emitWithAck(e,...t){return new Promise((s,r)=>{const d=(f,_)=>f?r(f):s(_);d.withError=!0,t.push(d),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...d)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...d)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:x.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case x.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case x.EVENT:case x.BINARY_EVENT:this.onevent(e);break;case x.ACK:case x.BINARY_ACK:this.onack(e);break;case x.DISCONNECT:this.ondisconnect();break;case x.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:x.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:x.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function ke(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}ke.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0};ke.prototype.reset=function(){this.attempts=0};ke.prototype.setMin=function(n){this.ms=n};ke.prototype.setMax=function(n){this.max=n};ke.prototype.setJitter=function(n){this.jitter=n};class wt extends N{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Ke(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new ke({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Tn;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new gn(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=J(t,"open",function(){s.onopen(),e&&e()}),d=_=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",_),e?e(_):this.maybeReconnectOnOpen()},f=J(t,"error",d);if(this._timeout!==!1){const _=this._timeout,b=this.setTimeoutFn(()=>{r(),d(new Error("timeout")),t.close()},_);this.opts.autoUnref&&b.unref(),this.subs.push(()=>{this.clearTimeoutFn(b)})}return this.subs.push(r),this.subs.push(f),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(J(e,"ping",this.onping.bind(this)),J(e,"data",this.ondata.bind(this)),J(e,"error",this.onerror.bind(this)),J(e,"close",this.onclose.bind(this)),J(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){We(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new ss(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Se={};function He(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=vn(n,e.path||"/socket.io"),s=t.source,r=t.id,d=t.path,f=Se[r]&&d in Se[r].nsps,_=e.forceNew||e["force new connection"]||e.multiplex===!1||f;let b;return _?b=new wt(s,e):(Se[r]||(Se[r]=new wt(s,e)),b=Se[r]),t.query&&!e.query&&(e.query=t.queryKey),b.socket(t.path,e)}Object.assign(He,{Manager:wt,Socket:ss,io:He,connect:He});const On="https://admin.monofloor.cloud";let I=null;const we=y(!1),be={};function Mn(){return I?.connected||(I=He(On,{transports:["websocket","polling"],autoConnect:!0}),I.on("connect",()=>{console.log("ðŸ”Œ Socket connected:",I?.id),we.value=!0,I?.emit("join:admin")}),I.on("disconnect",()=>{console.log("ðŸ”Œ Socket disconnected"),we.value=!1}),I.on("connect_error",n=>{console.log("ðŸ”Œ Socket connection error:",n.message),we.value=!1}),I.on("location:update",n=>{de("location:update",n)}),I.on("checkin:new",n=>{de("checkin:new",n)}),I.on("checkout:done",n=>{de("checkout:done",n)}),I.on("user:outOfArea",n=>{de("user:outOfArea",n)}),I.on("user:backInArea",n=>{de("user:backInArea",n)}),I.on("user:offline",n=>{de("user:offline",n)}),I.on("battery:critical",n=>{de("battery:critical",n)})),I}function Bn(){I&&(I.disconnect(),I=null,we.value=!1)}function Rn(n){return Me("location:update",n)}function Ln(n){return Me("checkin:new",n)}function Pn(n){return Me("checkout:done",n)}function Dn(n){return Me("user:outOfArea",n)}function Nn(n){return Me("user:backInArea",n)}function Me(n,e){return be[n]||(be[n]=[]),be[n].push(e),()=>{const t=be[n];if(t){const s=t.indexOf(e);s>-1&&t.splice(s,1)}}}function de(n,e){be[n]&&be[n].forEach(t=>{try{t(e)}catch(s){console.error(`Error in ${n} listener:`,s)}})}const In={class:"page"},$n={class:"mobile-nav"},Un={class:"mobile-sidebar-footer"},qn={class:"mobile-user-info"},zn={class:"user-avatar"},Vn=["src"],Fn={key:1},jn={class:"user-name"},Hn={class:"header"},Wn={class:"nav desktop-nav"},Kn={class:"header-right"},Yn={class:"user-info"},Xn={class:"user-avatar"},Jn=["src"],Gn={key:1},Qn={class:"user-name"},Zn={class:"main"},ei={class:"page-header"},ti={class:"header-actions"},si={class:"stats-badges"},ni=["disabled"],ii={class:"map-container"},oi={key:0,class:"map-view-toggle"},ri={key:1,class:"map-loading"},ai={key:2,class:"map-error"},li={key:0,class:"error-hint"},ci={key:3,class:"last-update"},ui={key:0,class:"timeline-sidebar"},hi={class:"timeline-date-picker"},di={class:"timeline-applicator-list"},pi={class:"timeline-search-container"},fi={key:0,class:"empty-list"},gi=["onClick"],vi={class:"applicator-avatar"},mi=["src","alt"],yi={key:1},bi={key:2,class:"online-dot"},wi={class:"applicator-details"},ki={class:"applicator-name"},_i={key:1,class:"timeline-controls"},xi={class:"timeline-info"},Ci={class:"selected-user"},Ei=["src","alt"],Ai={key:1,class:"user-avatar-small initials"},Ti={class:"user-name-label"},Si={class:"current-time-display"},Oi={key:0,class:"points-count"},Mi={key:0,class:"no-data-message"},Bi={key:1,class:"slider-container"},Ri={class:"time-label start"},Li=["min","max"],Pi={class:"time-label end"},Di={key:2,class:"timeline-loading"},Ni={class:"sidebar-header-row"},Ii={key:0,class:"sidebar-header-title"},$i=["title"],Ui={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"18",height:"18"},qi={key:0,points:"9 18 15 12 9 6"},zi={key:1,points:"15 18 9 12 15 6"},Vi={class:"sidebar-content"},Fi={class:"sidebar-view-toggle"},ji={class:"toggle-count"},Hi={class:"toggle-count"},Wi={class:"sidebar-search"},Ki=["placeholder"],Yi={key:0,class:"sidebar-status-filters"},Xi={key:1,class:"sidebar-filter-info"},Ji={key:2,class:"applicator-list"},Gi={key:0,class:"no-results"},Qi=["onClick"],Zi=["src","alt"],eo={key:0,class:"online-indicator em-campo"},to={key:1,class:"online-indicator"},so={class:"applicator-info"},no={class:"applicator-name-row"},io={class:"applicator-name"},oo=["title"],ro={class:"applicator-project-row"},ao={class:"applicator-project"},lo={key:0,class:"out-of-area-badge",title:"Fora do raio de 200m do projeto"},co={key:3,class:"projects-list"},uo={key:0,class:"no-results"},ho=["onClick"],po={key:0,class:"project-user-count"},fo={class:"project-info"},go={class:"project-title"},vo={key:0,class:"project-cliente"},mo={class:"project-status-row"},yo=Cs({__name:"Map",setup(n){const e=y(!1),t=()=>{e.value=!e.value},s=()=>{e.value=!1},r=()=>{window.innerWidth>=768&&(e.value=!1)},d=Rs(),f=Es(),_="https://admin.monofloor.cloud",b=y(!1),j=y(!1),z=y([]),R=y(null),H=y(""),Be=y(new Date().toISOString().split("T")[0]),L=y(null),pe=y(null),fe=y(null),re=y([]),ge=y(new Map),ae=y(null),ve=y(0),me=y(0),Re=y(100),_e=y(null),ns=y(!1),Ye=y(null);y(1);const At=a=>new Date(a).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),is=Ie(()=>_e.value?_e.value.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--:--"),os=async()=>{try{const a=await Ue.getApplicatorsList();z.value=a.data.data.applicators}catch(a){console.error("Error loading applicators list:",a)}},Tt=Ie(()=>{const a=H.value.toLowerCase().trim();return a?z.value.filter(i=>i.name.toLowerCase().includes(a)):z.value}),St=async()=>{try{const a=await Ue.getProjectsForMap();re.value=a.data.data.projects,rs()}catch(a){console.error("Error loading projects for map:",a)}},rs=()=>{if(!T.value)return;ae.value||(ae.value=new google.maps.InfoWindow),ge.value.forEach(i=>i.setMap(null)),ge.value.clear(),xe.value.clear(),re.value.forEach(i=>{i.activeUsers&&i.activeUsers.forEach(c=>xe.value.add(c.id))}),re.value.forEach(i=>{if(!i.lat||!i.lng)return;const c=i.hasActiveCheckin,l=i.activeUsers?.length||0,h=c?"#22c55e":"#ef4444";let w;l>0?w={path:google.maps.SymbolPath.CIRCLE,fillColor:h,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:12+Math.min(l*2,8)}:w={path:google.maps.SymbolPath.CIRCLE,fillColor:h,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:10};const P=V.value==="all"||V.value==="projects",u=new google.maps.Marker({position:{lat:i.lat,lng:i.lng},map:P?T.value:null,icon:w,label:l>0?{text:String(l),color:"#ffffff",fontSize:"11px",fontWeight:"bold"}:void 0,title:i.title,zIndex:500,visible:P}),p=c?"#22c55e":"#ef4444",m=c?`${l} EM CAMPO`:"SEM EQUIPE",C=c?"rgba(34, 197, 94, 0.15)":"rgba(239, 68, 68, 0.15)",S=i.activeUsers?.length>0?i.activeUsers.map(D=>`<span style="background: rgba(34, 197, 94, 0.2); padding: 2px 8px; border-radius: 4px; font-size: 11px; color: #22c55e;">${D.name}</span>`).join(" "):"",$=`
      <div style="padding: 14px; min-width: 220px; background: #1a1a2e; border-radius: 10px; font-family: 'Inter', sans-serif; border: 2px solid ${p}40;">
        <div style="font-weight: 600; font-size: 13px; color: #fff; margin-bottom: 8px;">
          ${i.title}
        </div>

        <div style="display: inline-block; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; padding: 3px 8px; border-radius: 4px; background: ${C}; color: ${p}; margin-bottom: 10px;">
          ${m}
        </div>

        ${S?`
          <div style="margin-bottom: 10px;">
            <div style="font-size: 10px; color: #8892b0; margin-bottom: 4px;">Em campo:</div>
            <div style="display: flex; flex-wrap: wrap; gap: 4px;">${S}</div>
          </div>
        `:""}

        ${i.cliente?`
          <div style="font-size: 12px; color: #8892b0; margin-bottom: 4px;">
            <span style="color: #c9a962;">Cliente:</span> ${i.cliente}
          </div>
        `:""}

        ${i.endereco?`
          <div style="font-size: 11px; color: #6b7280; line-height: 1.3;">
            ${i.endereco.substring(0,60)}${i.endereco.length>60?"...":""}
          </div>
        `:""}
      </div>
    `;u.addListener("mouseover",()=>{Ce.value?.close(),se.value?.close(),ae.value?.setContent($),ae.value?.open(T.value,u)}),u.addListener("mouseout",()=>{ae.value?.close()}),ge.value.set(i.id,u)});const a=V.value==="all"||V.value==="projects";ge.value.forEach(i=>{i.setVisible(a),a||i.setMap(null)}),Ne()},Ot=async()=>{if(R.value){j.value=!0;try{const a=await Ue.getTimeline(R.value.id,Be.value);if(L.value=a.data.data,L.value.points&&L.value.points.length>0){const i=L.value.points[0],c=L.value.points[L.value.points.length-1];me.value=i.timestampMs,Re.value=c.timestampMs,ve.value=i.timestampMs,_e.value=new Date(me.value),as(),T.value?.setCenter({lat:i.lat,lng:i.lng}),T.value?.setZoom(15),Mt()}else L.value.bounds&&(me.value=L.value.bounds.startMs,Re.value=L.value.bounds.endMs,ve.value=L.value.bounds.startMs,_e.value=new Date(me.value))}catch(a){console.error("Error loading timeline:",a)}finally{j.value=!1}}},as=()=>{if(fe.value&&fe.value.setMap(null),!L.value?.points?.length||!T.value)return;const a=L.value.points.map(i=>({lat:i.lat,lng:i.lng}));fe.value=new google.maps.Polyline({path:a,geodesic:!0,strokeColor:"#c9a962",strokeOpacity:.7,strokeWeight:3,map:T.value})},ls=a=>{if(!L.value?.points?.length)return null;const i=L.value.points;let c=null,l=null;for(let w=0;w<i.length;w++)if(i[w].timestampMs<=a&&(c=i[w]),i[w].timestampMs>=a&&!l){l=i[w];break}if(!c&&l)return{lat:l.lat,lng:l.lng};if(c&&!l)return{lat:c.lat,lng:c.lng};if(!c&&!l)return null;if(c.timestampMs===l.timestampMs)return{lat:c.lat,lng:c.lng};const h=(a-c.timestampMs)/(l.timestampMs-c.timestampMs);return{lat:c.lat+(l.lat-c.lat)*h,lng:c.lng+(l.lng-c.lng)*h}},cs=async a=>{if(!a)return{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3};try{const i=te(a);if(!i)return{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3};const c=48,l=document.createElement("canvas");l.width=c,l.height=c;const h=l.getContext("2d");if(!h)throw new Error("No canvas context");const w=new Image;return w.crossOrigin="anonymous",new Promise(P=>{w.onload=()=>{h.beginPath(),h.arc(c/2,c/2,c/2,0,Math.PI*2),h.fillStyle="#ffffff",h.fill(),h.beginPath(),h.arc(c/2,c/2,c/2-3,0,Math.PI*2),h.clip(),h.drawImage(w,3,3,c-6,c-6);const u=l.toDataURL("image/png");P({url:u,scaledSize:new google.maps.Size(c,c),anchor:new google.maps.Point(c/2,c/2)})},w.onerror=()=>{P({path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3})},w.src=i})}catch(i){return console.error("Error creating photo marker:",i),{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3}}},Mt=async()=>{if(!T.value)return;const a=ls(ve.value);if(!a)return;_e.value=new Date(ve.value);const i=L.value?.user?.photoUrl||R.value?.photoUrl;if(pe.value)pe.value.setPosition(a);else{const c=await cs(i);pe.value=new google.maps.Marker({position:a,map:T.value,icon:c,zIndex:1e3})}},Bt=()=>{ns.value=!1,Ye.value&&(clearInterval(Ye.value),Ye.value=null)},us=async()=>{b.value=!b.value,b.value?(await os(),Q.value.forEach(a=>a.setMap(null)),Q.value=[],O.value.forEach(a=>{a.setMap(null),a.setVisible(!1)})):(Bt(),R.value=null,L.value=null,pe.value&&(pe.value.setMap(null),pe.value=null),fe.value&&(fe.value.setMap(null),fe.value=null),Ne())},hs=async a=>{R.value=a,Bt(),await Ot()};As(Be,()=>{R.value&&Ot()});const te=a=>a?a.startsWith("http")?a:`${_}${a}`:null,Le=a=>a?a.split(" ").map(i=>i[0]).join("").substring(0,2).toUpperCase():"?",Xe=y(null),T=y(null),O=y(new Map),xe=y(new Set),se=y(null),Ce=y(null),Je=y(!0),Pe=y(""),De=y(null),Rt=y(!0),Ge=y(null);let Qe=null,Ze=null,et=null,tt=null,st=null;const ds=y(new Map),nt=y(0),it=y(0),ot=y(0),ps=y(null),K=y(""),B=y("all"),V=y("all"),G=y("equipe"),le=y(!1),F=a=>a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),rt=Ie(()=>{const a=F(K.value.trim());return re.value.filter(i=>{const c=F(i.title||""),l=F(i.cliente||""),h=F(i.endereco||"");return!a||c.includes(a)||l.includes(a)||h.includes(a)})}),Lt=Ie(()=>{const a=F(K.value.trim()),i=[];return O.value.forEach((c,l)=>{const h=c.userData;if(!h)return;const w=F(h.user?.name||""),P=F(h.project?.title||""),u=F(h.user?.role||""),p=!a||w.includes(a)||P.includes(a)||u.includes(a);let m=!0;B.value!=="all"&&(B.value==="emCampo"?m=h.hasActiveCheckin===!0:B.value==="online"?m=h.isOnline&&!h.hasActiveCheckin:B.value==="offline"&&(m=!h.isOnline&&!h.hasActiveCheckin)),p&&m&&i.push([l,c])}),i}),ye=a=>{B.value===a?B.value="all":B.value=a,ce()},ce=()=>{const a=F(K.value.trim());O.value.forEach((c,l)=>{const h=c.userData;if(!h)return;const w=F(h.user?.name||""),P=F(h.project?.title||""),u=!a||w.includes(a)||P.includes(a);let p=!0;B.value!=="all"&&(B.value==="emCampo"?p=h.hasActiveCheckin===!0:B.value==="online"?p=h.isOnline&&!h.hasActiveCheckin:B.value==="offline"&&(p=!h.isOnline&&!h.hasActiveCheckin));const m=V.value==="all"||V.value==="applicators",C=u&&p&&m;c.setVisible(C),c.setMap(C?T.value:null)});const i=V.value==="all"||V.value==="projects";ge.value.forEach(c=>{c.setVisible(i),c.setMap(i?T.value:null)}),Ne()},fs=a=>{const i=a.userId;if(ds.value.set(i,{batteryLevel:a.batteryLevel,isCharging:a.isCharging,isOutOfArea:a.isOutOfArea,distanceFromProject:a.distanceFromProject}),O.value.has(i)){const c=O.value.get(i);c.setPosition({lat:a.latitude,lng:a.longitude});const l=c.userData;if(l){l.isOutOfArea=a.isOutOfArea,l.batteryLevel=a.batteryLevel,l.isCharging=a.isCharging;const h=l.user?.role||"",w=l.user?.name||"";c.setIcon(at(!0,h,w,a.isOutOfArea))}De.value=new Date}console.log(`ðŸ“ Real-time update: ${a.userName} at (${a.latitude.toFixed(4)}, ${a.longitude.toFixed(4)}) - Battery: ${a.batteryLevel}%`)},Pt="AIzaSyAGl3uuilMmSmSiGWdiV9ySwKq70nNEX-E",Dt=()=>{f.logout(),d.push("/login")},gs=a=>{const i=new Date,c=new Date(a),l=Math.floor((i.getTime()-c.getTime())/6e4);return l<1?"Agora":l<60?`${l}min atras`:l<1440?`${Math.floor(l/60)}h atras`:c.toLocaleDateString("pt-BR")},vs=a=>a==null?"#9ca3af":a>50?"#22c55e":a>20?"#f59e0b":"#ef4444",ms=(a,i)=>i?"âš¡":a==null||a>50||a>20?"ðŸ”‹":"ðŸª«",ys=()=>new Promise((a,i)=>{if(window.google?.maps){a();return}const c=document.querySelector('script[src*="maps.googleapis.com"]');if(c){c.addEventListener("load",()=>a()),c.addEventListener("error",()=>i(new Error("Failed to load Google Maps")));return}const l=document.createElement("script");l.src=`https://maps.googleapis.com/maps/api/js?key=${Pt}&libraries=places`,l.async=!0,l.defer=!0,l.onload=()=>a(),l.onerror=()=>i(new Error("Failed to load Google Maps")),document.head.appendChild(l)}),bs=async()=>{if(Xe.value)try{await ys();const a={lat:-23.5505,lng:-46.6333},i=[{elementType:"geometry",stylers:[{color:"#1a1a2e"}]},{elementType:"labels.text.fill",stylers:[{color:"#8892b0"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a1a2e"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#c9a962"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#7c8594"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#1e3a2f"},{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#2d3748"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#5c4d3c"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1a1a2e"},{weight:1}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#c9a962"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#3d4a5c"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#8892b0"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#2a3441"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#6b7280"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0f1729"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4a5568"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#1f2937"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#1a2332"}]}];T.value=new google.maps.Map(Xe.value,{center:a,zoom:12,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,styles:i}),Ce.value=new google.maps.InfoWindow,await Ee(),await St(),Mn(),Qe=Rn(fs),Ze=Ln(()=>Ee()),et=Pn(()=>Ee()),tt=Dn(c=>{console.log("User out of area:",c.userName,c.distance,"m")}),st=Nn(c=>{console.log("User back in area:",c.userName)}),Ge.value=window.setInterval(async()=>{await Ee(),await St(),ce()},6e4)}catch(a){Pe.value=a.message||"Erro ao carregar mapa",console.error("Map init error:",a)}finally{Je.value=!1}},ue="/",he={lider:{label:"LÃ­der",icon:`${ue}icons/lider.png`,color:"#FF6B35",width:359,height:289},aplicador_1:{label:"Aplicador 1",icon:`${ue}icons/aplicador-1.png`,color:"#9B5DE5",width:250,height:223},aplicador_2:{label:"Aplicador 2",icon:`${ue}icons/aplicador-2.png`,color:"#9B5DE5",width:317,height:212},aplicador_3:{label:"Aplicador 3",icon:`${ue}icons/aplicador-3.png`,color:"#9B5DE5",width:411,height:259},lider_preparacao:{label:"LÃ­der Prep",icon:`${ue}icons/lider-preparacao.png`,color:"#3B82F6",width:314,height:262},preparador:{label:"Preparador",icon:`${ue}icons/preparador.png`,color:"#00D4FF",width:281,height:216},auxiliar:{label:"Ajudante",icon:`${ue}icons/ajudante.png`,color:"#8B7355",width:187,height:228}},ne=(a,i)=>{switch(a){case"LIDER":return"lider";case"APLICADOR_III":return"aplicador_3";case"APLICADOR_II":return"aplicador_2";case"APLICADOR_I":return"aplicador_1";case"LIDER_PREPARACAO":return"lider_preparacao";case"PREPARADOR":return"preparador";case"AUXILIAR":case"AJUDANTE":default:return"auxiliar"}},at=(a,i,c,l)=>{const h=ne(i||""),w=he[h],P=36,u=w.width/w.height,p=Math.round(P*u),m=P;return{url:w.icon,scaledSize:new google.maps.Size(p,m),anchor:new google.maps.Point(Math.round(p/2),m)}},Ee=async()=>{try{const i=(await Ue.getMapData()).data.data;nt.value=i.emCampoCount||0,it.value=i.onlineCount||0,ot.value=i.offlineCount||0,De.value=new Date;const c=new Set;i.markers.forEach(l=>{c.add(l.id);const h={lat:l.lat,lng:l.lng},w=l.user?.role||"",P=l.user?.name||"";if(O.value.has(l.id)){const u=O.value.get(l.id);u.setPosition(h),u.setIcon(at(l.isOnline,w,P)),u.userData=l}else{const u=new google.maps.Marker({position:h,icon:at(l.isOnline,w,P),title:l.user.name,visible:!1});u.userData=l,u.addListener("click",()=>{const p=u.userData;ps.value=p;const m=ne(p.user?.role||"",p.user?.name||""),C=he[m];let S="#ef4444",$="OFFLINE",D="";p.hasActiveCheckin?(S="#22c55e",$="EM CAMPO",D="trabalhando agora"):p.isOnline&&(S="#eab308",$="ONLINE",D="sem check-in");const ie=`${S}20`,lt=he[m].icon,Y=`
            <div style="padding: 16px; min-width: 260px; background: #1a1a2e; border-radius: 12px; font-family: 'Inter', sans-serif; border: 2px solid ${S}40;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                <div style="width: 52px; height: 52px; border-radius: 12px; background: ${C.color}20; display: flex; align-items: center; justify-content: center; border: 2px solid ${C.color}; overflow: hidden;">
                  <img src="${lt}" style="width: 44px; height: 44px; object-fit: contain;" />
                </div>
                <div style="flex: 1;">
                  <div style="font-weight: 600; font-size: 15px; color: #fff; margin-bottom: 4px;">
                    ${p.user.name}
                  </div>
                  <div style="font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; padding: 2px 8px; border-radius: 4px; background: ${C.color}20; color: ${C.color}; display: inline-block;">
                    ${C.label}
                  </div>
                </div>
              </div>

              <div style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: ${ie}; border-radius: 8px; margin-bottom: 12px;">
                <span style="width: 12px; height: 12px; border-radius: 50%; background: ${S}; box-shadow: 0 0 10px ${S};"></span>
                <span style="font-size: 13px; font-weight: 600; color: ${S};">${$}</span>
                ${D?`<span style="font-size: 11px; color: #8892b0; margin-left: auto;">${D}</span>`:""}
              </div>

              ${p.project?`
                <div style="padding: 12px; background: rgba(201, 169, 98, 0.1); border-radius: 8px; border-left: 3px solid #c9a962;">
                  <div style="font-size: 10px; color: #8892b0; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">ðŸ“ Projeto Atual</div>
                  <div style="font-weight: 600; color: #fff; font-size: 14px;">${p.project.title}</div>
                  ${p.project.cliente?`<div style="font-size: 12px; color: #c9a962; margin-top: 4px;">ðŸ‘¤ ${p.project.cliente}</div>`:""}
                </div>
              `:`
                <div style="padding: 12px; background: rgba(136, 146, 176, 0.1); border-radius: 8px; text-align: center;">
                  <span style="font-size: 12px; color: #8892b0;">ðŸ“­ Sem projeto atribuido</span>
                </div>
              `}

              <div style="font-size: 11px; color: #5a6578; margin-top: 12px; text-align: center; padding-top: 8px; border-top: 1px solid #2d2d44;">
                ðŸ• ${gs(p.lastSeen)}
              </div>
            </div>
          `;se.value?.close(),ae.value?.close(),Ce.value?.setContent(Y),Ce.value?.open(T.value,u)}),O.value.set(l.id,u)}}),O.value.forEach((l,h)=>{c.has(h)||(l.setMap(null),O.value.delete(h))}),Ne(),Rt.value&&i.markers.length>0&&i.center&&(T.value?.setCenter(i.center),Rt.value=!1)}catch(a){console.error("Error loading locations:",a)}},Q=y([]),Nt=(a,i,c,l)=>{const w=(c-a)*Math.PI/180,P=(l-i)*Math.PI/180,u=Math.sin(w/2)*Math.sin(w/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(P/2)*Math.sin(P/2);return 6371e3*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))},Ne=()=>{if(!T.value)return;for(console.log("ðŸ”„ setupMarkerClusterer START. Clusters to clear:",Q.value.length);Q.value.length>0;){const u=Q.value.pop();console.log(`   Removing cluster from map (remaining: ${Q.value.length})`),google.maps.event.clearInstanceListeners(u),u.setVisible(!1),u.setMap(null)}if(O.value.forEach(u=>{u.setMap(null),u.setVisible(!1)}),console.log("ðŸ” setupMarkerClusterer: All markers removed from map"),se.value||(se.value=new google.maps.InfoWindow),b.value)return;if(V.value==="projects"){console.log('ðŸ” View mode is "projects" - hiding all applicator markers');return}const a=F(K.value.trim()),i=[];if(O.value.forEach(u=>{const p=u.userData;if(!p)return;const m=F(p.user?.name||""),C=F(p.project?.title||""),S=!a||m.includes(a)||C.includes(a);let $=!0;B.value!=="all"&&(B.value==="emCampo"?$=p.hasActiveCheckin===!0:B.value==="online"?$=p.isOnline&&!p.hasActiveCheckin:B.value==="offline"&&($=!p.isOnline&&!p.hasActiveCheckin)),S&&$&&i.push(u)}),i.length===0){console.log("ðŸ” No markers match the current filters");return}const c=200,l=new Set,h=[];for(const u of i){if(l.has(u))continue;const p=u.getPosition();if(!p)continue;const m=[u];l.add(u);for(const C of i){if(l.has(C))continue;const S=C.getPosition();if(!S)continue;Nt(p.lat(),p.lng(),S.lat(),S.lng())<=c&&(m.push(C),l.add(C))}h.push(m)}if(console.log("ðŸ” Clustering Debug:"),console.log(`   Total markers: ${O.value.size}`),console.log(`   Users with active check-in: ${xe.value.size}`),console.log(`   Clusters formed: ${h.length}`),i.forEach((u,p)=>{const m=u.getPosition(),C=u.userData?.user?.name||"Unknown";console.log(`   ðŸ“ Marker ${p+1}: ${C} at (${m?.lat().toFixed(6)}, ${m?.lng().toFixed(6)})`)}),i.length>=2)for(let u=0;u<Math.min(3,i.length);u++)for(let p=u+1;p<Math.min(4,i.length);p++){const m=i[u].getPosition(),C=i[p].getPosition();if(m&&C){const S=Nt(m.lat(),m.lng(),C.lat(),C.lng()),$=i[u].userData?.user?.name||"Unknown",D=i[p].userData?.user?.name||"Unknown";console.log(`   ðŸ“ Distance ${$} â†” ${D}: ${S.toFixed(0)}m ${S<=200?"âœ… WITHIN CLUSTER RANGE":""}`)}}h.forEach((u,p)=>{const m=u.map(C=>C.userData?.user?.name||"Unknown").join(", ");console.log(`   Cluster ${p+1}: ${u.length} members [${m}]`)});for(const u of h)if(u.length===1){const p=u[0].userData,m=p?.user?.name||"Unknown";p?.id;let C;O.value.forEach((S,$)=>{S===u[0]&&(C=$)}),C&&xe.value.has(C)?(console.log(`   â­ï¸ Skipping individual (has check-in): ${m}`),u[0].setMap(null),u[0].setVisible(!1)):(console.log(`   âœ… Showing individual: ${m}`),u[0].setVisible(!0),u[0].setMap(T.value))}else{u.forEach(D=>{D.setMap(null),D.setVisible(!1)}),console.log(`   ðŸ”µ Creating cluster with ${u.length} members`);const p=u.reduce((D,ie)=>D+(ie.getPosition()?.lat()||0),0)/u.length,m=u.reduce((D,ie)=>D+(ie.getPosition()?.lng()||0),0)/u.length,C=56+Math.min(u.length*2,20),S=new google.maps.Marker({position:{lat:p,lng:m},map:T.value,icon:{url:"/grupo.png",scaledSize:new google.maps.Size(C,C),anchor:new google.maps.Point(C/2,C/2)},label:{text:String(u.length),color:"#ffffff",fontSize:"14px",fontWeight:"bold"},zIndex:1e3});S.clusterMembers=u,S.addListener("click",()=>{const D=S.clusterMembers;if(!D||D.length===0)return;const ie=D.map(Y=>{const Ae=Y.userData;if(!Ae)return null;const xs=ne(Ae.user?.role||""),ct=he[xs];return{name:Ae.user?.name||"Desconhecido",role:ct.label,roleColor:ct.color,icon:ct.icon,isOnline:Ae.isOnline,project:Ae.project?.title||"Sem projeto"}}).filter(Boolean),lt=`
          <div style="padding: 16px; min-width: 280px; max-width: 320px; background: #1a1a2e; border-radius: 12px; font-family: 'Inter', sans-serif; border: 2px solid rgba(201, 169, 98, 0.4);">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 14px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <img src="/grupo.png" style="width: 36px; height: 36px; object-fit: contain;" />
              <div>
                <div style="font-weight: 600; font-size: 15px; color: #fff;">Equipe Agrupada</div>
                <div style="font-size: 12px; color: #c9a962;">${ie.length} aplicadores</div>
              </div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 10px; max-height: 250px; overflow-y: auto;">
              ${ie.map(Y=>`
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                  <div style="position: relative; width: 36px; height: 36px; flex-shrink: 0;">
                    <img src="${Y.icon}" style="width: 100%; height: 100%; object-fit: contain;" />
                    ${Y.isOnline?'<span style="position: absolute; top: 0; right: 0; width: 10px; height: 10px; background: #22c55e; border: 2px solid #1a1a2e; border-radius: 50%;"></span>':""}
                  </div>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-size: 13px; font-weight: 500; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${Y.name}</div>
                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 2px;">
                      <span style="font-size: 10px; font-weight: 600; text-transform: uppercase; padding: 2px 6px; border-radius: 4px; background: ${Y.roleColor}20; color: ${Y.roleColor};">${Y.role}</span>
                    </div>
                    <div style="font-size: 11px; color: #6b7280; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${Y.project}</div>
                  </div>
                </div>
              `).join("")}
            </div>
          </div>
        `;Ce.value?.close(),ae.value?.close(),se.value?.setContent(lt),se.value?.setPosition({lat:p,lng:m}),se.value?.open(T.value)}),Q.value.push(S);const $=u.map(D=>D.userData?.user?.name||"Unknown").join(", ");console.log(`   ðŸ”µ Created cluster with ${u.length} members [${$}]`)}const w=new Set;h.forEach(u=>{u.length>1&&u.forEach(p=>w.add(p))}),w.forEach(u=>{u.setMap(null),u.setVisible(!1)}),console.log(`ðŸ” Final safety: Force-hid ${w.size} markers in clusters`),Array.from(O.value.values()).filter(u=>u.getMap()!==null).map(u=>u.userData?.user?.name);const P=Array.from(O.value.values()).filter(u=>u.getVisible()).map(u=>u.userData?.user?.name);console.log("ðŸ” ========== END CLUSTERING SUMMARY =========="),console.log(`   ðŸ”µ Cluster icons created: ${Q.value.length}`),console.log(`   ðŸ‘¤ Individual markers visible: ${P.length} [${P.join(", ")}]`),console.log(`   ðŸ“ Total applicators: ${O.value.size}`),console.log(`   âœ… Users with check-in (shown in projects): ${xe.value.size}`),console.log("================================================"),setTimeout(()=>{const u=Array.from(O.value.values()).filter(m=>m.getMap()!==null).map(m=>m.userData?.user?.name),p=Array.from(O.value.values()).filter(m=>m.getVisible()).map(m=>m.userData?.user?.name);(u.length>0||p.length>0)&&(console.warn("âš ï¸ PROBLEM: Markers appeared after clustering!"),console.warn("   Map set:",u),console.warn("   Visible:",p),w.forEach(m=>{m.setMap(null),m.setVisible(!1)}))},500)},ws=a=>{const i=O.value.get(a);i&&T.value&&(T.value.panTo(i.getPosition()),T.value.setZoom(15),google.maps.event.trigger(i,"click"))},ks=a=>{if(!T.value||!a.lat||!a.lng)return;T.value.panTo({lat:a.lat,lng:a.lng}),T.value.setZoom(16);const i=ge.value.get(a.id);i&&google.maps.event.trigger(i,"mouseover")},_s=()=>{if(!T.value||O.value.size===0)return;const a=new google.maps.LatLngBounds;O.value.forEach(i=>{const c=i.getPosition();c&&a.extend({lat:c.lat(),lng:c.lng()})}),T.value.fitBounds(a)};return Ts(()=>{bs(),window.addEventListener("resize",r)}),Ss(()=>{window.removeEventListener("resize",r),Ge.value&&clearInterval(Ge.value),Q.value.forEach(a=>a.setMap(null)),Q.value=[],se.value&&se.value.close(),Qe&&Qe(),Ze&&Ze(),et&&et(),tt&&tt(),st&&st(),Bn()}),(a,i)=>{const c=Os("router-link");return v(),g("div",In,[e.value?(v(),g("div",{key:0,class:"mobile-overlay",onClick:s})):E("",!0),o("aside",{class:M(["mobile-sidebar",{open:e.value}])},[o("div",{class:"mobile-sidebar-header"},[i[19]||(i[19]=o("img",{src:$t,alt:"Monofloor",class:"header-logo"},null,-1)),o("button",{class:"close-menu-btn",onClick:s},[...i[18]||(i[18]=[o("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),o("nav",$n,[U(c,{to:"/",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[20]||(i[20]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("rect",{x:"3",y:"3",width:"7",height:"9"}),o("rect",{x:"14",y:"3",width:"7",height:"5"}),o("rect",{x:"14",y:"12",width:"7",height:"9"}),o("rect",{x:"3",y:"16",width:"7",height:"5"})],-1),A("Dashboard",-1)])]),_:1}),U(c,{to:"/applicators",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[21]||(i[21]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),o("circle",{cx:"9",cy:"7",r:"4"}),o("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),o("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})],-1),A("Aplicadores",-1)])]),_:1}),U(c,{to:"/projects",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[22]||(i[22]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),o("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),A("Projetos",-1)])]),_:1}),U(c,{to:"/reports",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[23]||(i[23]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o("polyline",{points:"14 2 14 8 20 8"})],-1),A("Relatorios",-1)])]),_:1}),U(c,{to:"/requests",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[24]||(i[24]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o("polyline",{points:"14 2 14 8 20 8"}),o("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),o("line",{x1:"9",y1:"15",x2:"15",y2:"15"})],-1),A("Solicitacoes",-1)])]),_:1}),U(c,{to:"/campaigns",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[25]||(i[25]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),o("line",{x1:"4",y1:"22",x2:"4",y2:"15"})],-1),A("Campanhas",-1)])]),_:1}),U(c,{to:"/academy",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[26]||(i[26]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o("polyline",{points:"2 17 12 22 22 17"}),o("polyline",{points:"2 12 12 17 22 12"})],-1),A("Academia",-1)])]),_:1}),U(c,{to:"/map",class:"mobile-nav-link",onClick:s},{default:q(()=>[...i[27]||(i[27]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),o("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),o("line",{x1:"16",y1:"6",x2:"16",y2:"22"})],-1),A("Mapa",-1)])]),_:1})]),o("div",Un,[o("div",qn,[o("div",zn,[te(X(f).user?.photoUrl)?(v(),g("img",{key:0,src:te(X(f).user?.photoUrl),alt:"Avatar",class:"avatar-img"},null,8,Vn)):(v(),g("span",Fn,k(Le(X(f).user?.name)),1))]),o("span",jn,k(X(f).user?.name),1)]),o("button",{onClick:Dt,class:"mobile-logout-btn"},[...i[28]||(i[28]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o("polyline",{points:"16 17 21 12 16 7"}),o("line",{x1:"21",y1:"12",x2:"9",y2:"12"})],-1),A("Sair",-1)])])])],2),o("header",Hn,[o("div",{class:"header-left"},[o("button",{class:"hamburger-btn",onClick:t},[...i[29]||(i[29]=[o("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),o("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),o("line",{x1:"3",y1:"18",x2:"21",y2:"18"})],-1)])]),i[30]||(i[30]=o("img",{src:$t,alt:"Monofloor",class:"header-logo"},null,-1)),i[31]||(i[31]=o("span",{class:"logo-badge"},"ADMIN",-1))]),o("nav",Wn,[U(c,{to:"/",class:"nav-link"},{default:q(()=>[...i[32]||(i[32]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),o("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),A(" Dashboard ",-1)])]),_:1}),U(c,{to:"/applicators",class:"nav-link"},{default:q(()=>[...i[33]||(i[33]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),o("circle",{cx:"9",cy:"7",r:"4"}),o("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),o("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})],-1),A(" Aplicadores ",-1)])]),_:1}),U(c,{to:"/projects",class:"nav-link"},{default:q(()=>[...i[34]||(i[34]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1),A(" Projetos ",-1)])]),_:1}),U(c,{to:"/reports",class:"nav-link"},{default:q(()=>[...i[35]||(i[35]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o("polyline",{points:"14 2 14 8 20 8"}),o("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),o("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),o("polyline",{points:"10 9 9 9 8 9"})],-1),A(" Relatorios ",-1)])]),_:1}),U(c,{to:"/requests",class:"nav-link"},{default:q(()=>[...i[36]||(i[36]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),o("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})],-1),A(" Solicitacoes ",-1)])]),_:1}),U(c,{to:"/campaigns",class:"nav-link"},{default:q(()=>[...i[37]||(i[37]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),o("line",{x1:"4",y1:"22",x2:"4",y2:"15"})],-1),A(" Campanhas ",-1)])]),_:1}),U(c,{to:"/academy",class:"nav-link"},{default:q(()=>[...i[38]||(i[38]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o("polyline",{points:"2 17 12 22 22 17"}),o("polyline",{points:"2 12 12 17 22 12"})],-1),A(" Academia ",-1)])]),_:1}),U(c,{to:"/map",class:"nav-link"},{default:q(()=>[...i[39]||(i[39]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),o("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),o("line",{x1:"16",y1:"6",x2:"16",y2:"22"})],-1),A(" Mapa ",-1)])]),_:1}),U(c,{to:"/scheduling",class:"nav-link"},{default:q(()=>[...i[40]||(i[40]=[o("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),o("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),o("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),o("line",{x1:"3",y1:"10",x2:"21",y2:"10"})],-1),A(" Agenda ",-1)])]),_:1})]),o("div",Kn,[o("div",Yn,[o("div",Xn,[te(X(f).user?.photoUrl)?(v(),g("img",{key:0,src:te(X(f).user?.photoUrl),alt:"Avatar",class:"avatar-img"},null,8,Jn)):(v(),g("span",Gn,k(Le(X(f).user?.name)),1))]),o("span",Qn,k(X(f).user?.name),1)]),o("button",{onClick:Dt,class:"logout-btn"},[...i[41]||(i[41]=[o("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o("polyline",{points:"16 17 21 12 16 7"}),o("line",{x1:"21",y1:"12",x2:"9",y2:"12"})],-1),A(" Sair ",-1)])])])]),o("main",Zn,[o("div",ei,[i[49]||(i[49]=o("div",{class:"page-title"},[o("h2",null,"Mapa de Equipes"),o("p",{class:"page-subtitle"},"Acompanhe a localizacao dos aplicadores em tempo real")],-1)),o("div",ti,[o("div",si,[o("div",{class:M(["stat-badge",X(we)?"realtime":"disconnected"])},[i[42]||(i[42]=o("span",{class:"stat-dot"},null,-1)),o("span",null,k(X(we)?"Tempo real":"Reconectando..."),1)],2),o("div",{class:M(["stat-badge em-campo clickable",{active:B.value==="emCampo"}]),onClick:i[0]||(i[0]=l=>ye("emCampo")),title:"Clique para filtrar"},[i[43]||(i[43]=o("span",{class:"stat-dot"},null,-1)),o("span",null,k(nt.value)+" em campo",1)],2),o("div",{class:M(["stat-badge online clickable",{active:B.value==="online"}]),onClick:i[1]||(i[1]=l=>ye("online")),title:"Clique para filtrar"},[i[44]||(i[44]=o("span",{class:"stat-dot"},null,-1)),o("span",null,k(it.value)+" online",1)],2),o("div",{class:M(["stat-badge offline clickable",{active:B.value==="offline"}]),onClick:i[2]||(i[2]=l=>ye("offline")),title:"Clique para filtrar"},[i[45]||(i[45]=o("span",{class:"stat-dot"},null,-1)),o("span",null,k(ot.value)+" offline",1)],2)]),o("button",{onClick:_s,class:"btn btn-secondary",disabled:O.value.size===0},[...i[46]||(i[46]=[o("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"})],-1),A(" Ver Todos ",-1)])],8,ni),o("button",{onClick:us,class:M(["btn",b.value?"btn-primary":"btn-secondary"])},[i[47]||(i[47]=o("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("circle",{cx:"12",cy:"12",r:"10"}),o("polyline",{points:"12 6 12 12 16 14"})],-1)),A(" "+k(b.value?"Sair Timeline":"Timeline"),1)],2),b.value?E("",!0):(v(),g("button",{key:0,onClick:Ee,class:"btn btn-primary"},[...i[48]||(i[48]=[o("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polyline",{points:"23 4 23 10 17 10"}),o("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})],-1),A(" Atualizar ",-1)])]))])]),o("div",ii,[!Je.value&&!Pe.value?(v(),g("div",oi,[o("button",{class:M(["toggle-btn",{active:V.value==="all"}]),onClick:i[3]||(i[3]=l=>{V.value="all",ce()})},[...i[50]||(i[50]=[It('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" data-v-80057a48><rect x="3" y="3" width="18" height="18" rx="2" data-v-80057a48></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-80057a48></circle><circle cx="15.5" cy="8.5" r="1.5" data-v-80057a48></circle><circle cx="8.5" cy="15.5" r="1.5" data-v-80057a48></circle><circle cx="15.5" cy="15.5" r="1.5" data-v-80057a48></circle></svg> Todos ',2)])],2),o("button",{class:M(["toggle-btn",{active:V.value==="applicators"}]),onClick:i[4]||(i[4]=l=>{V.value="applicators",ce()})},[...i[51]||(i[51]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[o("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o("circle",{cx:"12",cy:"7",r:"4"})],-1),A(" Aplicadores ",-1)])],2),o("button",{class:M(["toggle-btn",{active:V.value==="projects"}]),onClick:i[5]||(i[5]=l=>{V.value="projects",ce()})},[...i[52]||(i[52]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[o("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{cx:"12",cy:"10",r:"3"})],-1),A(" Projetos ",-1)])],2)])):E("",!0),Je.value?(v(),g("div",ri,[...i[53]||(i[53]=[o("div",{class:"loading-spinner"},null,-1),o("span",null,"Carregando mapa...",-1)])])):Pe.value?(v(),g("div",ai,[i[54]||(i[54]=o("svg",{class:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),o("p",null,k(Pe.value),1),X(Pt)?E("",!0):(v(),g("p",li," Adicione VITE_GOOGLE_MAPS_API_KEY no arquivo .env "))])):E("",!0),o("div",{ref_key:"mapContainer",ref:Xe,class:"map"},null,512),De.value?(v(),g("div",ci," Atualizado: "+k(De.value.toLocaleTimeString("pt-BR")),1)):E("",!0)]),b.value?(v(),g("div",ui,[i[59]||(i[59]=It('<div class="sidebar-header" data-v-80057a48><div class="sidebar-title" data-v-80057a48><svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20" data-v-80057a48><circle cx="12" cy="12" r="10" data-v-80057a48></circle><polyline points="12 6 12 12 16 14" data-v-80057a48></polyline></svg><span data-v-80057a48>Timeline</span></div></div>',1)),o("div",hi,[i[55]||(i[55]=o("label",null,"Data",-1)),Te(o("input",{type:"date","onUpdate:modelValue":i[6]||(i[6]=l=>Be.value=l),class:"date-input"},null,512),[[$e,Be.value]])]),o("div",di,[i[58]||(i[58]=o("div",{class:"list-header"},"Selecione um aplicador",-1)),o("div",pi,[i[57]||(i[57]=o("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[o("circle",{cx:"11",cy:"11",r:"8"}),o("path",{d:"M21 21l-4.35-4.35"})],-1)),Te(o("input",{type:"text","onUpdate:modelValue":i[7]||(i[7]=l=>H.value=l),placeholder:"Buscar aplicador...",class:"timeline-search-input"},null,512),[[$e,H.value]]),H.value?(v(),g("button",{key:0,class:"clear-search-btn",onClick:i[8]||(i[8]=l=>H.value="")},[...i[56]||(i[56]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"14",height:"14"},[o("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])):E("",!0)]),Tt.value.length===0?(v(),g("div",fi,k(H.value?"Nenhum resultado encontrado":"Nenhum aplicador encontrado"),1)):E("",!0),(v(!0),g(ut,null,ht(Tt.value,l=>(v(),g("div",{key:l.id,class:M(["timeline-applicator-item",{selected:R.value?.id===l.id,online:l.isOnline}]),onClick:h=>hs(l)},[o("div",vi,[te(l.photoUrl)?(v(),g("img",{key:0,src:te(l.photoUrl),alt:l.name,class:"avatar-img"},null,8,mi)):(v(),g("span",yi,k(Le(l.name)),1)),l.isOnline?(v(),g("span",bi)):E("",!0)]),o("div",wi,[o("span",ki,k(l.name),1),o("span",{class:M(["applicator-status",{online:l.isOnline}])},k(l.isOnline?"Online":"Offline"),3)])],10,gi))),128))])])):E("",!0),b.value&&R.value?(v(),g("div",_i,[o("div",xi,[o("div",Ci,[te(R.value.photoUrl)?(v(),g("img",{key:0,src:te(R.value.photoUrl),alt:R.value.name,class:"user-avatar-small"},null,8,Ei)):(v(),g("span",Ai,k(Le(R.value.name)),1)),o("span",Ti,k(R.value.name),1)]),o("div",Si,[i[60]||(i[60]=o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[o("circle",{cx:"12",cy:"12",r:"10"}),o("polyline",{points:"12 6 12 12 16 14"})],-1)),o("span",null,k(is.value),1)]),L.value?(v(),g("div",Oi,k(L.value.points?.length||0)+" pontos ",1)):E("",!0)]),!L.value||!L.value.points?.length?(v(),g("div",Mi,[...i[61]||(i[61]=[o("span",null,"Sem registros de localizaÃ§Ã£o para esta data",-1)])])):E("",!0),L.value&&L.value.points?.length>0?(v(),g("div",Bi,[o("span",Ri,k(At(me.value)),1),Te(o("input",{type:"range","onUpdate:modelValue":i[9]||(i[9]=l=>ve.value=l),min:me.value,max:Re.value,class:"timeline-slider",onInput:Mt},null,40,Li),[[$e,ve.value,void 0,{number:!0}]]),o("span",Pi,k(At(Re.value)),1)])):E("",!0),j.value?(v(),g("div",Di,[...i[62]||(i[62]=[o("div",{class:"mini-spinner"},null,-1),o("span",null,"Carregando...",-1)])])):E("",!0)])):E("",!0),(O.value.size>0||re.value.length>0)&&!b.value?(v(),g("div",{key:2,class:M(["applicators-sidebar",{collapsed:le.value}])},[o("div",Ni,[le.value?E("",!0):(v(),g("div",Ii,[o("span",null,k(G.value==="equipe"?"Equipe em Campo":"Projetos"),1)])),o("button",{class:"sidebar-collapse-btn",onClick:i[10]||(i[10]=l=>le.value=!le.value),title:le.value?"Expandir":"Recolher"},[(v(),g("svg",Ui,[le.value?(v(),g("polyline",qi)):(v(),g("polyline",zi))]))],8,$i)]),Te(o("div",Vi,[o("div",Fi,[o("button",{class:M(["sidebar-toggle-btn",{active:G.value==="equipe"}]),onClick:i[11]||(i[11]=l=>{G.value="equipe",K.value="",B.value="all"})},[i[63]||(i[63]=o("img",{src:Ps,alt:"Equipe",style:{width:"20px",height:"20px","object-fit":"contain"}},null,-1)),i[64]||(i[64]=o("span",null,"Equipe",-1)),o("span",ji,k(O.value.size),1)],2),o("button",{class:M(["sidebar-toggle-btn",{active:G.value==="projetos"}]),onClick:i[12]||(i[12]=l=>{G.value="projetos",K.value="",B.value="all"})},[i[65]||(i[65]=o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"18",height:"18"},[o("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{cx:"12",cy:"10",r:"3"})],-1)),i[66]||(i[66]=o("span",null,"Projetos",-1)),o("span",Hi,k(re.value.length),1)],2)]),o("div",Wi,[i[68]||(i[68]=o("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("circle",{cx:"11",cy:"11",r:"8"}),o("path",{d:"m21 21-4.35-4.35"})],-1)),Te(o("input",{type:"text","onUpdate:modelValue":i[13]||(i[13]=l=>K.value=l),onInput:ce,placeholder:G.value==="equipe"?"Buscar por nome...":"Buscar projeto...",class:"sidebar-search-input"},null,40,Ki),[[$e,K.value]]),K.value?(v(),g("button",{key:0,onClick:i[14]||(i[14]=l=>{K.value="",ce()}),class:"search-clear"},[...i[67]||(i[67]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"14",height:"14"},[o("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):E("",!0)]),G.value==="equipe"?(v(),g("div",Yi,[o("button",{class:M(["status-pill em-campo",{active:B.value==="emCampo"}]),onClick:i[15]||(i[15]=l=>ye("emCampo"))},[i[69]||(i[69]=o("span",{class:"status-dot"},null,-1)),A(" "+k(nt.value),1)],2),o("button",{class:M(["status-pill online",{active:B.value==="online"}]),onClick:i[16]||(i[16]=l=>ye("online"))},[i[70]||(i[70]=o("span",{class:"status-dot"},null,-1)),A(" "+k(it.value),1)],2),o("button",{class:M(["status-pill offline",{active:B.value==="offline"}]),onClick:i[17]||(i[17]=l=>ye("offline"))},[i[71]||(i[71]=o("span",{class:"status-dot"},null,-1)),A(" "+k(ot.value),1)],2)])):E("",!0),G.value==="projetos"&&K.value?(v(),g("div",Xi,[o("span",null,k(rt.value.length)+" de "+k(re.value.length)+" projetos",1)])):E("",!0),G.value==="equipe"?(v(),g("div",Ji,[Lt.value.length===0?(v(),g("div",Gi,[...i[72]||(i[72]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[o("circle",{cx:"11",cy:"11",r:"8"}),o("path",{d:"m21 21-4.35-4.35"})],-1),o("span",null,"Nenhum resultado encontrado",-1)])])):E("",!0),(v(!0),g(ut,null,ht(Lt.value,([l,h])=>(v(),g("div",{key:l,class:M(["applicator-item",{online:h.userData?.isOnline,[ne(h.userData?.user?.role||"",h.userData?.user?.name||"")]:!0}]),onClick:w=>ws(l)},[o("div",{class:M(["character-avatar",[{online:h.userData?.isOnline||h.userData?.hasActiveCheckin,offline:!h.userData?.isOnline&&!h.userData?.hasActiveCheckin},ne(h.userData?.user?.role||"",h.userData?.user?.name||"")]])},[o("img",{src:he[ne(h.userData?.user?.role||"")].icon,alt:he[ne(h.userData?.user?.role||"")].label,class:M(["avatar-icon",{offline:!h.userData?.isOnline&&!h.userData?.hasActiveCheckin}])},null,10,Zi),h.userData?.hasActiveCheckin?(v(),g("span",eo)):h.userData?.isOnline?(v(),g("span",to)):E("",!0)],2),o("div",so,[o("div",no,[o("span",io,k(h.userData?.user?.name),1),h.userData?.batteryLevel!==null&&h.userData?.batteryLevel!==void 0?(v(),g("span",{key:0,class:"battery-indicator",style:Bs({color:vs(h.userData?.batteryLevel)}),title:`Bateria: ${h.userData?.batteryLevel}%${h.userData?.isCharging?" (carregando)":""}`},k(ms(h.userData?.batteryLevel,h.userData?.isCharging))+" "+k(h.userData?.batteryLevel)+"% ",13,oo)):E("",!0)]),o("span",{class:M(["applicator-role",ne(h.userData?.user?.role||"",h.userData?.user?.name||"")])},k(he[ne(h.userData?.user?.role||"")].label),3),o("div",ro,[o("span",ao,k(h.userData?.project?.title||"Sem projeto"),1),h.userData?.isOutOfArea?(v(),g("span",lo," FORA DA ÃREA ")):E("",!0)])]),i[73]||(i[73]=o("div",{class:"applicator-arrow"},[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polyline",{points:"9 18 15 12 9 6"})])],-1))],10,Qi))),128))])):E("",!0),G.value==="projetos"?(v(),g("div",co,[rt.value.length===0?(v(),g("div",uo,[...i[74]||(i[74]=[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[o("circle",{cx:"11",cy:"11",r:"8"}),o("path",{d:"m21 21-4.35-4.35"})],-1),o("span",null,"Nenhum projeto encontrado",-1)])])):E("",!0),(v(!0),g(ut,null,ht(rt.value,l=>(v(),g("div",{key:l.id,class:M(["project-item",{"has-team":l.hasActiveCheckin}]),onClick:h=>ks(l)},[o("div",{class:M(["project-icon",{active:l.hasActiveCheckin}])},[i[75]||(i[75]=o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{cx:"12",cy:"10",r:"3"})],-1)),l.activeUsers?.length?(v(),g("span",po,k(l.activeUsers.length),1)):E("",!0)],2),o("div",fo,[o("div",go,k(l.title),1),l.cliente?(v(),g("div",vo,k(l.cliente),1)):E("",!0),o("div",mo,[o("span",{class:M(["project-status-badge",l.hasActiveCheckin?"active":"empty"])},k(l.hasActiveCheckin?`${l.activeUsers?.length||0} em campo`:"Sem equipe"),3)])]),i[76]||(i[76]=o("div",{class:"project-arrow"},[o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polyline",{points:"9 18 15 12 9 6"})])],-1))],10,ho))),128))])):E("",!0)],512),[[Ms,!le.value]])],2)):E("",!0)])])}}}),_o=Ls(yo,[["__scopeId","data-v-80057a48"]]);export{_o as default};
