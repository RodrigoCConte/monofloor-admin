import{d as Ct,r as d,u as Mt,D as fe,E as $t,k as At,l as _t,c as r,e as f,b as t,m as A,n as _,p as Dt,g as I,t as v,q as h,s as b,a as Ze,f as re,v as he,F as ze,y as Oe,L as Tt,z as Et,i as St,M as me,o as c,_ as Pt}from"./index-BzdWGBMK.js";import{_ as Qe}from"./logo-CxXS7KxG.js";import{i as Xe,c as It,a as Lt,b as Bt,d as zt,e as Ot,f as Ut,g as jt}from"./socket-CQohDNAV.js";const Rt="/grupo.png",Vt={class:"page"},Nt={class:"mobile-nav"},Ft={class:"mobile-sidebar-footer"},qt={class:"mobile-user-info"},Wt={class:"user-avatar"},Ht=["src"],Gt={key:1},Kt={class:"user-name"},Yt={class:"header"},Zt={class:"nav desktop-nav"},Qt={class:"header-right"},Xt={class:"user-info"},Jt={class:"user-avatar"},es=["src"],ts={key:1},ss={class:"user-name"},ls={class:"main"},os={class:"page-header"},as={class:"header-actions"},ns={class:"stats-badges"},is=["disabled"],rs={class:"map-container"},cs={key:0,class:"map-view-toggle"},us={key:1,class:"map-loading"},ds={key:2,class:"map-error"},ps={key:0,class:"error-hint"},vs={key:3,class:"last-update"},gs={key:0,class:"timeline-sidebar"},fs={class:"timeline-date-picker"},hs={class:"timeline-applicator-list"},ms={class:"timeline-search-container"},ys={key:0,class:"empty-list"},xs=["onClick"],bs={class:"applicator-avatar"},ws=["src","alt"],ks={key:1},Cs={key:2,class:"online-dot"},Ms={class:"applicator-details"},$s={class:"applicator-name"},As={key:1,class:"timeline-controls"},_s={class:"timeline-info"},Ds={class:"selected-user"},Ts=["src","alt"],Es={key:1,class:"user-avatar-small initials"},Ss={class:"user-name-label"},Ps={class:"current-time-display"},Is={key:0,class:"points-count"},Ls={key:0,class:"no-data-message"},Bs={key:1,class:"slider-container"},zs={class:"time-label start"},Os=["min","max"],Us={class:"time-label end"},js={key:2,class:"timeline-loading"},Rs={class:"sidebar-header-row"},Vs={key:0,class:"sidebar-header-title"},Ns=["title"],Fs={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"18",height:"18"},qs={key:0,points:"9 18 15 12 9 6"},Ws={key:1,points:"15 18 9 12 15 6"},Hs={class:"sidebar-content"},Gs={class:"sidebar-view-toggle"},Ks={class:"toggle-count"},Ys={class:"toggle-count"},Zs={class:"sidebar-search"},Qs=["placeholder"],Xs={key:0,class:"sidebar-status-filters"},Js={key:1,class:"sidebar-filter-info"},el={key:2,class:"applicator-list"},tl={key:0,class:"no-results"},sl=["onClick"],ll=["src","alt"],ol={key:0,class:"online-indicator em-campo"},al={key:1,class:"online-indicator"},nl={class:"applicator-info"},il={class:"applicator-name-row"},rl={class:"applicator-name"},cl=["title"],ul={class:"applicator-project-row"},dl={class:"applicator-project"},pl={key:0,class:"out-of-area-badge",title:"Fora do raio de 200m do projeto"},vl={key:3,class:"projects-list"},gl={key:0,class:"no-results"},fl=["onClick"],hl={key:0,class:"project-user-count"},ml={class:"project-info"},yl={class:"project-title"},xl={key:0,class:"project-cliente"},bl={class:"project-status-row"},wl=Ct({__name:"Map",setup(kl){const Y=d(!1),Je=()=>{Y.value=!Y.value},L=()=>{Y.value=!1},Ue=()=>{window.innerWidth>=768&&(Y.value=!1)},et=St(),U=Mt(),tt="https://devoted-wholeness-production.up.railway.app",B=d(!1),ye=d(!1),xe=d([]),E=d(null),Z=d(""),ce=d(new Date().toISOString().split("T")[0]),k=d(null),Q=d(null),X=d(null),F=d([]),J=d(new Map),q=d(null),ee=d(0),te=d(0),ue=d(100),le=d(null),st=d(!1),be=d(null);d(1);const je=s=>new Date(s).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),lt=fe(()=>le.value?le.value.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--:--"),ot=async()=>{try{const s=await me.getApplicatorsList();xe.value=s.data.data.applicators}catch(s){console.error("Error loading applicators list:",s)}},Re=fe(()=>{const s=Z.value.toLowerCase().trim();return s?xe.value.filter(e=>e.name.toLowerCase().includes(s)):xe.value}),Ve=async()=>{try{const s=await me.getProjectsForMap();F.value=s.data.data.projects,at()}catch(s){console.error("Error loading projects for map:",s)}},at=()=>{if(!m.value)return;q.value||(q.value=new google.maps.InfoWindow),J.value.forEach(e=>e.setMap(null)),J.value.clear(),oe.value.clear(),F.value.forEach(e=>{e.activeUsers&&e.activeUsers.forEach(o=>oe.value.add(o.id))}),F.value.forEach(e=>{if(!e.lat||!e.lng)return;const o=e.hasActiveCheckin,l=e.activeUsers?.length||0,n=o?"#22c55e":"#ef4444";let p;l>0?p={path:google.maps.SymbolPath.CIRCLE,fillColor:n,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:12+Math.min(l*2,8)}:p={path:google.maps.SymbolPath.CIRCLE,fillColor:n,fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:10};const C=D.value==="all"||D.value==="projects",a=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:C?m.value:null,icon:p,label:l>0?{text:String(l),color:"#ffffff",fontSize:"11px",fontWeight:"bold"}:void 0,title:e.title,zIndex:500,visible:C}),i=o?"#22c55e":"#ef4444",u=o?`${l} EM CAMPO`:"SEM EQUIPE",g=o?"rgba(34, 197, 94, 0.15)":"rgba(239, 68, 68, 0.15)",y=e.activeUsers?.length>0?e.activeUsers.map(M=>`<span style="background: rgba(34, 197, 94, 0.2); padding: 2px 8px; border-radius: 4px; font-size: 11px; color: #22c55e;">${M.name}</span>`).join(" "):"",$=`
      <div style="padding: 14px; min-width: 220px; background: #1a1a2e; border-radius: 10px; font-family: 'Inter', sans-serif; border: 2px solid ${i}40;">
        <div style="font-weight: 600; font-size: 13px; color: #fff; margin-bottom: 8px;">
          ${e.title}
        </div>

        <div style="display: inline-block; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; padding: 3px 8px; border-radius: 4px; background: ${g}; color: ${i}; margin-bottom: 10px;">
          ${u}
        </div>

        ${y?`
          <div style="margin-bottom: 10px;">
            <div style="font-size: 10px; color: #8892b0; margin-bottom: 4px;">Em campo:</div>
            <div style="display: flex; flex-wrap: wrap; gap: 4px;">${y}</div>
          </div>
        `:""}

        ${e.cliente?`
          <div style="font-size: 12px; color: #8892b0; margin-bottom: 4px;">
            <span style="color: #c9a962;">Cliente:</span> ${e.cliente}
          </div>
        `:""}

        ${e.endereco?`
          <div style="font-size: 11px; color: #6b7280; line-height: 1.3;">
            ${e.endereco.substring(0,60)}${e.endereco.length>60?"...":""}
          </div>
        `:""}
      </div>
    `;a.addListener("mouseover",()=>{ae.value?.close(),R.value?.close(),q.value?.setContent($),q.value?.open(m.value,a)}),a.addListener("mouseout",()=>{q.value?.close()}),J.value.set(e.id,a)});const s=D.value==="all"||D.value==="projects";J.value.forEach(e=>{e.setVisible(s),s||e.setMap(null)}),ge()},Ne=async()=>{if(E.value){ye.value=!0;try{const s=await me.getTimeline(E.value.id,ce.value);if(k.value=s.data.data,k.value.points&&k.value.points.length>0){const e=k.value.points[0],o=k.value.points[k.value.points.length-1];te.value=e.timestampMs,ue.value=o.timestampMs,ee.value=e.timestampMs,le.value=new Date(te.value),nt(),m.value?.setCenter({lat:e.lat,lng:e.lng}),m.value?.setZoom(15),Fe()}else k.value.bounds&&(te.value=k.value.bounds.startMs,ue.value=k.value.bounds.endMs,ee.value=k.value.bounds.startMs,le.value=new Date(te.value))}catch(s){console.error("Error loading timeline:",s)}finally{ye.value=!1}}},nt=()=>{if(X.value&&X.value.setMap(null),!k.value?.points?.length||!m.value)return;const s=k.value.points.map(e=>({lat:e.lat,lng:e.lng}));X.value=new google.maps.Polyline({path:s,geodesic:!0,strokeColor:"#c9a962",strokeOpacity:.7,strokeWeight:3,map:m.value})},it=s=>{if(!k.value?.points?.length)return null;const e=k.value.points;let o=null,l=null;for(let p=0;p<e.length;p++)if(e[p].timestampMs<=s&&(o=e[p]),e[p].timestampMs>=s&&!l){l=e[p];break}if(!o&&l)return{lat:l.lat,lng:l.lng};if(o&&!l)return{lat:o.lat,lng:o.lng};if(!o&&!l)return null;if(o.timestampMs===l.timestampMs)return{lat:o.lat,lng:o.lng};const n=(s-o.timestampMs)/(l.timestampMs-o.timestampMs);return{lat:o.lat+(l.lat-o.lat)*n,lng:o.lng+(l.lng-o.lng)*n}},rt=async s=>{if(!s)return{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3};try{const e=j(s);if(!e)return{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3};const o=48,l=document.createElement("canvas");l.width=o,l.height=o;const n=l.getContext("2d");if(!n)throw new Error("No canvas context");const p=new Image;return p.crossOrigin="anonymous",new Promise(C=>{p.onload=()=>{n.beginPath(),n.arc(o/2,o/2,o/2,0,Math.PI*2),n.fillStyle="#ffffff",n.fill(),n.beginPath(),n.arc(o/2,o/2,o/2-3,0,Math.PI*2),n.clip(),n.drawImage(p,3,3,o-6,o-6);const a=l.toDataURL("image/png");C({url:a,scaledSize:new google.maps.Size(o,o),anchor:new google.maps.Point(o/2,o/2)})},p.onerror=()=>{C({path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3})},p.src=e})}catch(e){return console.error("Error creating photo marker:",e),{path:google.maps.SymbolPath.CIRCLE,scale:14,fillColor:"#c9a962",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3}}},Fe=async()=>{if(!m.value)return;const s=it(ee.value);if(!s)return;le.value=new Date(ee.value);const e=k.value?.user?.photoUrl||E.value?.photoUrl;if(Q.value)Q.value.setPosition(s);else{const o=await rt(e);Q.value=new google.maps.Marker({position:s,map:m.value,icon:o,zIndex:1e3})}},qe=()=>{st.value=!1,be.value&&(clearInterval(be.value),be.value=null)},ct=async()=>{B.value=!B.value,B.value?(await ot(),O.value.forEach(s=>s.setMap(null)),O.value=[],x.value.forEach(s=>{s.setMap(null),s.setVisible(!1)})):(qe(),E.value=null,k.value=null,Q.value&&(Q.value.setMap(null),Q.value=null),X.value&&(X.value.setMap(null),X.value=null),ge())},ut=async s=>{E.value=s,qe(),await Ne()};$t(ce,()=>{E.value&&Ne()});const j=s=>s?s.startsWith("http")?s:`${tt}${s}`:null,de=s=>s?s.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",we=d(null),m=d(null),x=d(new Map),oe=d(new Set),R=d(null),ae=d(null),ke=d(!0),pe=d(""),ve=d(null),We=d(!0),Ce=d(null);let Me=null,$e=null,Ae=null,_e=null,De=null;const dt=d(new Map),Te=d(0),Ee=d(0),Se=d(0),pt=d(null),S=d(""),w=d("all"),D=d("all"),z=d("equipe"),W=d(!1),T=s=>s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Pe=fe(()=>{const s=T(S.value.trim());return F.value.filter(e=>{const o=T(e.title||""),l=T(e.cliente||""),n=T(e.endereco||"");return!s||o.includes(s)||l.includes(s)||n.includes(s)})}),He=fe(()=>{const s=T(S.value.trim()),e=[];return x.value.forEach((o,l)=>{const n=o.userData;if(!n)return;const p=T(n.user?.name||""),C=T(n.project?.title||""),a=T(n.user?.role||""),i=!s||p.includes(s)||C.includes(s)||a.includes(s);let u=!0;w.value!=="all"&&(w.value==="emCampo"?u=n.hasActiveCheckin===!0:w.value==="online"?u=n.isOnline&&!n.hasActiveCheckin:w.value==="offline"&&(u=!n.isOnline&&!n.hasActiveCheckin)),i&&u&&e.push([l,o])}),e}),se=s=>{w.value===s?w.value="all":w.value=s,H()},H=()=>{const s=T(S.value.trim());x.value.forEach((o,l)=>{const n=o.userData;if(!n)return;const p=T(n.user?.name||""),C=T(n.project?.title||""),a=!s||p.includes(s)||C.includes(s);let i=!0;w.value!=="all"&&(w.value==="emCampo"?i=n.hasActiveCheckin===!0:w.value==="online"?i=n.isOnline&&!n.hasActiveCheckin:w.value==="offline"&&(i=!n.isOnline&&!n.hasActiveCheckin));const u=D.value==="all"||D.value==="applicators",g=a&&i&&u;o.setVisible(g),o.setMap(g?m.value:null)});const e=D.value==="all"||D.value==="projects";J.value.forEach(o=>{o.setVisible(e),o.setMap(e?m.value:null)}),ge()},vt=s=>{const e=s.userId;if(dt.value.set(e,{batteryLevel:s.batteryLevel,isCharging:s.isCharging,isOutOfArea:s.isOutOfArea,distanceFromProject:s.distanceFromProject}),x.value.has(e)){const o=x.value.get(e);o.setPosition({lat:s.latitude,lng:s.longitude});const l=o.userData;if(l){l.isOutOfArea=s.isOutOfArea,l.batteryLevel=s.batteryLevel,l.isCharging=s.isCharging;const n=l.user?.role||"",p=l.user?.name||"";o.setIcon(Ie(!0,n,p,s.isOutOfArea))}ve.value=new Date}console.log(`üìç Real-time update: ${s.userName} at (${s.latitude.toFixed(4)}, ${s.longitude.toFixed(4)}) - Battery: ${s.batteryLevel}%`)},Ge="AIzaSyAGl3uuilMmSmSiGWdiV9ySwKq70nNEX-E",Ke=()=>{U.logout(),et.push("/login")},gt=s=>{const e=new Date,o=new Date(s),l=Math.floor((e.getTime()-o.getTime())/6e4);return l<1?"Agora":l<60?`${l}min atras`:l<1440?`${Math.floor(l/60)}h atras`:o.toLocaleDateString("pt-BR")},ft=s=>s==null?"#9ca3af":s>50?"#22c55e":s>20?"#f59e0b":"#ef4444",ht=(s,e)=>e?"‚ö°":s==null||s>50||s>20?"üîã":"ü™´",mt=()=>new Promise((s,e)=>{if(window.google?.maps){s();return}const o=document.querySelector('script[src*="maps.googleapis.com"]');if(o){o.addEventListener("load",()=>s()),o.addEventListener("error",()=>e(new Error("Failed to load Google Maps")));return}const l=document.createElement("script");l.src=`https://maps.googleapis.com/maps/api/js?key=${Ge}&libraries=places`,l.async=!0,l.defer=!0,l.onload=()=>s(),l.onerror=()=>e(new Error("Failed to load Google Maps")),document.head.appendChild(l)}),yt=async()=>{if(we.value)try{await mt();const s={lat:-23.5505,lng:-46.6333},e=[{elementType:"geometry",stylers:[{color:"#1a1a2e"}]},{elementType:"labels.text.fill",stylers:[{color:"#8892b0"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a1a2e"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#c9a962"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#7c8594"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#1e3a2f"},{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#2d3748"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#5c4d3c"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1a1a2e"},{weight:1}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#c9a962"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#3d4a5c"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#8892b0"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#2a3441"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#6b7280"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0f1729"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4a5568"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#1f2937"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#1a2332"}]}];m.value=new google.maps.Map(we.value,{center:s,zoom:12,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,styles:e}),ae.value=new google.maps.InfoWindow,await ne(),await Ve(),It(),Me=Lt(vt),$e=Bt(()=>ne()),Ae=zt(()=>ne()),_e=Ot(o=>{console.log("User out of area:",o.userName,o.distance,"m")}),De=Ut(o=>{console.log("User back in area:",o.userName)}),Ce.value=window.setInterval(async()=>{await ne(),await Ve(),H()},6e4)}catch(s){pe.value=s.message||"Erro ao carregar mapa",console.error("Map init error:",s)}finally{ke.value=!1}},G="/",K={lider:{label:"L√≠der",icon:`${G}icons/lider.png`,color:"#FF6B35",width:359,height:289},aplicador_1:{label:"Aplicador 1",icon:`${G}icons/aplicador-1.png`,color:"#9B5DE5",width:250,height:223},aplicador_2:{label:"Aplicador 2",icon:`${G}icons/aplicador-2.png`,color:"#9B5DE5",width:317,height:212},aplicador_3:{label:"Aplicador 3",icon:`${G}icons/aplicador-3.png`,color:"#9B5DE5",width:411,height:259},lider_preparacao:{label:"L√≠der Prep",icon:`${G}icons/lider-preparacao.png`,color:"#3B82F6",width:314,height:262},preparador:{label:"Preparador",icon:`${G}icons/preparador.png`,color:"#00D4FF",width:281,height:216},auxiliar:{label:"Ajudante",icon:`${G}icons/ajudante.png`,color:"#8B7355",width:187,height:228}},V=(s,e)=>{switch(s){case"LIDER":return"lider";case"APLICADOR_III":return"aplicador_3";case"APLICADOR_II":return"aplicador_2";case"APLICADOR_I":return"aplicador_1";case"LIDER_PREPARACAO":return"lider_preparacao";case"PREPARADOR":return"preparador";case"AUXILIAR":case"AJUDANTE":default:return"auxiliar"}},Ie=(s,e,o,l)=>{const n=V(e||""),p=K[n],C=36,a=p.width/p.height,i=Math.round(C*a),u=C;return{url:p.icon,scaledSize:new google.maps.Size(i,u),anchor:new google.maps.Point(Math.round(i/2),u)}},ne=async()=>{try{const e=(await me.getMapData()).data.data;Te.value=e.emCampoCount||0,Ee.value=e.onlineCount||0,Se.value=e.offlineCount||0,ve.value=new Date;const o=new Set;e.markers.forEach(l=>{o.add(l.id);const n={lat:l.lat,lng:l.lng},p=l.user?.role||"",C=l.user?.name||"";if(x.value.has(l.id)){const a=x.value.get(l.id);a.setPosition(n),a.setIcon(Ie(l.isOnline,p,C)),a.userData=l}else{const a=new google.maps.Marker({position:n,icon:Ie(l.isOnline,p,C),title:l.user.name,visible:!1});a.userData=l,a.addListener("click",()=>{const i=a.userData;pt.value=i;const u=V(i.user?.role||"",i.user?.name||""),g=K[u];let y="#ef4444",$="OFFLINE",M="";i.hasActiveCheckin?(y="#22c55e",$="EM CAMPO",M="trabalhando agora"):i.isOnline&&(y="#eab308",$="ONLINE",M="sem check-in");const N=`${y}20`,Le=K[u].icon,P=`
            <div style="padding: 16px; min-width: 260px; background: #1a1a2e; border-radius: 12px; font-family: 'Inter', sans-serif; border: 2px solid ${y}40;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                <div style="width: 52px; height: 52px; border-radius: 12px; background: ${g.color}20; display: flex; align-items: center; justify-content: center; border: 2px solid ${g.color}; overflow: hidden;">
                  <img src="${Le}" style="width: 44px; height: 44px; object-fit: contain;" />
                </div>
                <div style="flex: 1;">
                  <div style="font-weight: 600; font-size: 15px; color: #fff; margin-bottom: 4px;">
                    ${i.user.name}
                  </div>
                  <div style="font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; padding: 2px 8px; border-radius: 4px; background: ${g.color}20; color: ${g.color}; display: inline-block;">
                    ${g.label}
                  </div>
                </div>
              </div>

              <div style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: ${N}; border-radius: 8px; margin-bottom: 12px;">
                <span style="width: 12px; height: 12px; border-radius: 50%; background: ${y}; box-shadow: 0 0 10px ${y};"></span>
                <span style="font-size: 13px; font-weight: 600; color: ${y};">${$}</span>
                ${M?`<span style="font-size: 11px; color: #8892b0; margin-left: auto;">${M}</span>`:""}
              </div>

              ${i.project?`
                <div style="padding: 12px; background: rgba(201, 169, 98, 0.1); border-radius: 8px; border-left: 3px solid #c9a962;">
                  <div style="font-size: 10px; color: #8892b0; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;">üìç Projeto Atual</div>
                  <div style="font-weight: 600; color: #fff; font-size: 14px;">${i.project.title}</div>
                  ${i.project.cliente?`<div style="font-size: 12px; color: #c9a962; margin-top: 4px;">üë§ ${i.project.cliente}</div>`:""}
                </div>
              `:`
                <div style="padding: 12px; background: rgba(136, 146, 176, 0.1); border-radius: 8px; text-align: center;">
                  <span style="font-size: 12px; color: #8892b0;">üì≠ Sem projeto atribuido</span>
                </div>
              `}

              <div style="font-size: 11px; color: #5a6578; margin-top: 12px; text-align: center; padding-top: 8px; border-top: 1px solid #2d2d44;">
                üïê ${gt(i.lastSeen)}
              </div>
            </div>
          `;R.value?.close(),q.value?.close(),ae.value?.setContent(P),ae.value?.open(m.value,a)}),x.value.set(l.id,a)}}),x.value.forEach((l,n)=>{o.has(n)||(l.setMap(null),x.value.delete(n))}),ge(),We.value&&e.markers.length>0&&e.center&&(m.value?.setCenter(e.center),We.value=!1)}catch(s){console.error("Error loading locations:",s)}},O=d([]),Ye=(s,e,o,l)=>{const p=(o-s)*Math.PI/180,C=(l-e)*Math.PI/180,a=Math.sin(p/2)*Math.sin(p/2)+Math.cos(s*Math.PI/180)*Math.cos(o*Math.PI/180)*Math.sin(C/2)*Math.sin(C/2);return 6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))},ge=()=>{if(!m.value)return;for(console.log("üîÑ setupMarkerClusterer START. Clusters to clear:",O.value.length);O.value.length>0;){const a=O.value.pop();console.log(`   Removing cluster from map (remaining: ${O.value.length})`),google.maps.event.clearInstanceListeners(a),a.setVisible(!1),a.setMap(null)}if(x.value.forEach(a=>{a.setMap(null),a.setVisible(!1)}),console.log("üîç setupMarkerClusterer: All markers removed from map"),R.value||(R.value=new google.maps.InfoWindow),B.value)return;if(D.value==="projects"){console.log('üîç View mode is "projects" - hiding all applicator markers');return}const s=T(S.value.trim()),e=[];if(x.value.forEach(a=>{const i=a.userData;if(!i)return;const u=T(i.user?.name||""),g=T(i.project?.title||""),y=!s||u.includes(s)||g.includes(s);let $=!0;w.value!=="all"&&(w.value==="emCampo"?$=i.hasActiveCheckin===!0:w.value==="online"?$=i.isOnline&&!i.hasActiveCheckin:w.value==="offline"&&($=!i.isOnline&&!i.hasActiveCheckin)),y&&$&&e.push(a)}),e.length===0){console.log("üîç No markers match the current filters");return}const o=200,l=new Set,n=[];for(const a of e){if(l.has(a))continue;const i=a.getPosition();if(!i)continue;const u=[a];l.add(a);for(const g of e){if(l.has(g))continue;const y=g.getPosition();if(!y)continue;Ye(i.lat(),i.lng(),y.lat(),y.lng())<=o&&(u.push(g),l.add(g))}n.push(u)}if(console.log("üîç Clustering Debug:"),console.log(`   Total markers: ${x.value.size}`),console.log(`   Users with active check-in: ${oe.value.size}`),console.log(`   Clusters formed: ${n.length}`),e.forEach((a,i)=>{const u=a.getPosition(),g=a.userData?.user?.name||"Unknown";console.log(`   üìç Marker ${i+1}: ${g} at (${u?.lat().toFixed(6)}, ${u?.lng().toFixed(6)})`)}),e.length>=2)for(let a=0;a<Math.min(3,e.length);a++)for(let i=a+1;i<Math.min(4,e.length);i++){const u=e[a].getPosition(),g=e[i].getPosition();if(u&&g){const y=Ye(u.lat(),u.lng(),g.lat(),g.lng()),$=e[a].userData?.user?.name||"Unknown",M=e[i].userData?.user?.name||"Unknown";console.log(`   üìè Distance ${$} ‚Üî ${M}: ${y.toFixed(0)}m ${y<=200?"‚úÖ WITHIN CLUSTER RANGE":""}`)}}n.forEach((a,i)=>{const u=a.map(g=>g.userData?.user?.name||"Unknown").join(", ");console.log(`   Cluster ${i+1}: ${a.length} members [${u}]`)});for(const a of n)if(a.length===1){const i=a[0].userData,u=i?.user?.name||"Unknown";i?.id;let g;x.value.forEach((y,$)=>{y===a[0]&&(g=$)}),g&&oe.value.has(g)?(console.log(`   ‚è≠Ô∏è Skipping individual (has check-in): ${u}`),a[0].setMap(null),a[0].setVisible(!1)):(console.log(`   ‚úÖ Showing individual: ${u}`),a[0].setVisible(!0),a[0].setMap(m.value))}else{a.forEach(M=>{M.setMap(null),M.setVisible(!1)}),console.log(`   üîµ Creating cluster with ${a.length} members`);const i=a.reduce((M,N)=>M+(N.getPosition()?.lat()||0),0)/a.length,u=a.reduce((M,N)=>M+(N.getPosition()?.lng()||0),0)/a.length,g=56+Math.min(a.length*2,20),y=new google.maps.Marker({position:{lat:i,lng:u},map:m.value,icon:{url:"/grupo.png",scaledSize:new google.maps.Size(g,g),anchor:new google.maps.Point(g/2,g/2)},label:{text:String(a.length),color:"#ffffff",fontSize:"14px",fontWeight:"bold"},zIndex:1e3});y.clusterMembers=a,y.addListener("click",()=>{const M=y.clusterMembers;if(!M||M.length===0)return;const N=M.map(P=>{const ie=P.userData;if(!ie)return null;const kt=V(ie.user?.role||""),Be=K[kt];return{name:ie.user?.name||"Desconhecido",role:Be.label,roleColor:Be.color,icon:Be.icon,isOnline:ie.isOnline,project:ie.project?.title||"Sem projeto"}}).filter(Boolean),Le=`
          <div style="padding: 16px; min-width: 280px; max-width: 320px; background: #1a1a2e; border-radius: 12px; font-family: 'Inter', sans-serif; border: 2px solid rgba(201, 169, 98, 0.4);">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 14px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <img src="/grupo.png" style="width: 36px; height: 36px; object-fit: contain;" />
              <div>
                <div style="font-weight: 600; font-size: 15px; color: #fff;">Equipe Agrupada</div>
                <div style="font-size: 12px; color: #c9a962;">${N.length} aplicadores</div>
              </div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 10px; max-height: 250px; overflow-y: auto;">
              ${N.map(P=>`
                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                  <div style="position: relative; width: 36px; height: 36px; flex-shrink: 0;">
                    <img src="${P.icon}" style="width: 100%; height: 100%; object-fit: contain;" />
                    ${P.isOnline?'<span style="position: absolute; top: 0; right: 0; width: 10px; height: 10px; background: #22c55e; border: 2px solid #1a1a2e; border-radius: 50%;"></span>':""}
                  </div>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-size: 13px; font-weight: 500; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${P.name}</div>
                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 2px;">
                      <span style="font-size: 10px; font-weight: 600; text-transform: uppercase; padding: 2px 6px; border-radius: 4px; background: ${P.roleColor}20; color: ${P.roleColor};">${P.role}</span>
                    </div>
                    <div style="font-size: 11px; color: #6b7280; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${P.project}</div>
                  </div>
                </div>
              `).join("")}
            </div>
          </div>
        `;ae.value?.close(),q.value?.close(),R.value?.setContent(Le),R.value?.setPosition({lat:i,lng:u}),R.value?.open(m.value)}),O.value.push(y);const $=a.map(M=>M.userData?.user?.name||"Unknown").join(", ");console.log(`   üîµ Created cluster with ${a.length} members [${$}]`)}const p=new Set;n.forEach(a=>{a.length>1&&a.forEach(i=>p.add(i))}),p.forEach(a=>{a.setMap(null),a.setVisible(!1)}),console.log(`üîç Final safety: Force-hid ${p.size} markers in clusters`),Array.from(x.value.values()).filter(a=>a.getMap()!==null).map(a=>a.userData?.user?.name);const C=Array.from(x.value.values()).filter(a=>a.getVisible()).map(a=>a.userData?.user?.name);console.log("üîç ========== END CLUSTERING SUMMARY =========="),console.log(`   üîµ Cluster icons created: ${O.value.length}`),console.log(`   üë§ Individual markers visible: ${C.length} [${C.join(", ")}]`),console.log(`   üìç Total applicators: ${x.value.size}`),console.log(`   ‚úÖ Users with check-in (shown in projects): ${oe.value.size}`),console.log("================================================"),setTimeout(()=>{const a=Array.from(x.value.values()).filter(u=>u.getMap()!==null).map(u=>u.userData?.user?.name),i=Array.from(x.value.values()).filter(u=>u.getVisible()).map(u=>u.userData?.user?.name);(a.length>0||i.length>0)&&(console.warn("‚ö†Ô∏è PROBLEM: Markers appeared after clustering!"),console.warn("   Map set:",a),console.warn("   Visible:",i),p.forEach(u=>{u.setMap(null),u.setVisible(!1)}))},500)},xt=s=>{const e=x.value.get(s);e&&m.value&&(m.value.panTo(e.getPosition()),m.value.setZoom(15),google.maps.event.trigger(e,"click"))},bt=s=>{if(!m.value||!s.lat||!s.lng)return;m.value.panTo({lat:s.lat,lng:s.lng}),m.value.setZoom(16);const e=J.value.get(s.id);e&&google.maps.event.trigger(e,"mouseover")},wt=()=>{if(!m.value||x.value.size===0)return;const s=new google.maps.LatLngBounds;x.value.forEach(e=>{const o=e.getPosition();o&&s.extend({lat:o.lat(),lng:o.lng()})}),m.value.fitBounds(s)};return At(()=>{yt(),window.addEventListener("resize",Ue)}),_t(()=>{window.removeEventListener("resize",Ue),Ce.value&&clearInterval(Ce.value),O.value.forEach(s=>s.setMap(null)),O.value=[],R.value&&R.value.close(),Me&&Me(),$e&&$e(),Ae&&Ae(),_e&&_e(),De&&De(),jt()}),(s,e)=>{const o=Dt("router-link");return c(),r("div",Vt,[Y.value?(c(),r("div",{key:0,class:"mobile-overlay",onClick:L})):f("",!0),t("aside",{class:b(["mobile-sidebar",{open:Y.value}])},[t("div",{class:"mobile-sidebar-header"},[e[19]||(e[19]=t("img",{src:Qe,alt:"Monofloor",class:"header-logo"},null,-1)),t("button",{class:"close-menu-btn",onClick:L},[...e[18]||(e[18]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),t("nav",Nt,[A(o,{to:"/",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[20]||(e[20]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"7",height:"9"}),t("rect",{x:"14",y:"3",width:"7",height:"5"}),t("rect",{x:"14",y:"12",width:"7",height:"9"}),t("rect",{x:"3",y:"16",width:"7",height:"5"})],-1),h("Dashboard",-1)])]),_:1}),A(o,{to:"/applicators",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[21]||(e[21]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),t("circle",{cx:"9",cy:"7",r:"4"}),t("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),t("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})],-1),h("Aplicadores",-1)])]),_:1}),A(o,{to:"/projects",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[22]||(e[22]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),t("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),h("Projetos",-1)])]),_:1}),A(o,{to:"/reports",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[23]||(e[23]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),t("polyline",{points:"14 2 14 8 20 8"})],-1),h("Relatorios",-1)])]),_:1}),A(o,{to:"/requests",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[24]||(e[24]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),t("polyline",{points:"14 2 14 8 20 8"}),t("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),t("line",{x1:"9",y1:"15",x2:"15",y2:"15"})],-1),h("Solicitacoes",-1)])]),_:1}),A(o,{to:"/campaigns",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[25]||(e[25]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),t("line",{x1:"4",y1:"22",x2:"4",y2:"15"})],-1),h("Campanhas",-1)])]),_:1}),A(o,{to:"/academy",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[26]||(e[26]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),t("polyline",{points:"2 17 12 22 22 17"}),t("polyline",{points:"2 12 12 17 22 12"})],-1),h("Academia",-1)])]),_:1}),A(o,{to:"/map",class:"mobile-nav-link",onClick:L},{default:_(()=>[...e[27]||(e[27]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),t("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),t("line",{x1:"16",y1:"6",x2:"16",y2:"22"})],-1),h("Mapa",-1)])]),_:1})]),t("div",Ft,[t("div",qt,[t("div",Wt,[j(I(U).user?.photoUrl)?(c(),r("img",{key:0,src:j(I(U).user?.photoUrl),alt:"Avatar",class:"avatar-img"},null,8,Ht)):(c(),r("span",Gt,v(de(I(U).user?.name)),1))]),t("span",Kt,v(I(U).user?.name),1)]),t("button",{onClick:Ke,class:"mobile-logout-btn"},[...e[28]||(e[28]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})],-1),h("Sair",-1)])])])],2),t("header",Yt,[t("div",{class:"header-left"},[t("button",{class:"hamburger-btn",onClick:Je},[...e[29]||(e[29]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),t("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),t("line",{x1:"3",y1:"18",x2:"21",y2:"18"})],-1)])]),e[30]||(e[30]=t("img",{src:Qe,alt:"Monofloor",class:"header-logo"},null,-1)),e[31]||(e[31]=t("span",{class:"logo-badge"},"ADMIN",-1))]),t("nav",Zt,[A(o,{to:"/",class:"nav-link"},{default:_(()=>[...e[32]||(e[32]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),t("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),h(" Dashboard ",-1)])]),_:1}),A(o,{to:"/applicators",class:"nav-link"},{default:_(()=>[...e[33]||(e[33]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),t("circle",{cx:"9",cy:"7",r:"4"}),t("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),t("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})],-1),h(" Aplicadores ",-1)])]),_:1}),A(o,{to:"/projects",class:"nav-link"},{default:_(()=>[...e[34]||(e[34]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1),h(" Projetos ",-1)])]),_:1}),A(o,{to:"/reports",class:"nav-link"},{default:_(()=>[...e[35]||(e[35]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),t("polyline",{points:"14 2 14 8 20 8"}),t("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),t("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),t("polyline",{points:"10 9 9 9 8 9"})],-1),h(" Relatorios ",-1)])]),_:1}),A(o,{to:"/requests",class:"nav-link"},{default:_(()=>[...e[36]||(e[36]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),t("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})],-1),h(" Solicitacoes ",-1)])]),_:1}),A(o,{to:"/campaigns",class:"nav-link"},{default:_(()=>[...e[37]||(e[37]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),t("line",{x1:"4",y1:"22",x2:"4",y2:"15"})],-1),h(" Campanhas ",-1)])]),_:1}),A(o,{to:"/academy",class:"nav-link"},{default:_(()=>[...e[38]||(e[38]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),t("polyline",{points:"2 17 12 22 22 17"}),t("polyline",{points:"2 12 12 17 22 12"})],-1),h(" Academia ",-1)])]),_:1}),A(o,{to:"/map",class:"nav-link"},{default:_(()=>[...e[39]||(e[39]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),t("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),t("line",{x1:"16",y1:"6",x2:"16",y2:"22"})],-1),h(" Mapa ",-1)])]),_:1}),A(o,{to:"/scheduling",class:"nav-link"},{default:_(()=>[...e[40]||(e[40]=[t("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),t("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),t("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),t("line",{x1:"3",y1:"10",x2:"21",y2:"10"})],-1),h(" Agenda ",-1)])]),_:1})]),t("div",Qt,[t("div",Xt,[t("div",Jt,[j(I(U).user?.photoUrl)?(c(),r("img",{key:0,src:j(I(U).user?.photoUrl),alt:"Avatar",class:"avatar-img"},null,8,es)):(c(),r("span",ts,v(de(I(U).user?.name)),1))]),t("span",ss,v(I(U).user?.name),1)]),t("button",{onClick:Ke,class:"logout-btn"},[...e[41]||(e[41]=[t("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})],-1),h(" Sair ",-1)])])])]),t("main",ls,[t("div",os,[e[49]||(e[49]=t("div",{class:"page-title"},[t("h2",null,"Mapa de Equipes"),t("p",{class:"page-subtitle"},"Acompanhe a localizacao dos aplicadores em tempo real")],-1)),t("div",as,[t("div",ns,[t("div",{class:b(["stat-badge",I(Xe)?"realtime":"disconnected"])},[e[42]||(e[42]=t("span",{class:"stat-dot"},null,-1)),t("span",null,v(I(Xe)?"Tempo real":"Reconectando..."),1)],2),t("div",{class:b(["stat-badge em-campo clickable",{active:w.value==="emCampo"}]),onClick:e[0]||(e[0]=l=>se("emCampo")),title:"Clique para filtrar"},[e[43]||(e[43]=t("span",{class:"stat-dot"},null,-1)),t("span",null,v(Te.value)+" em campo",1)],2),t("div",{class:b(["stat-badge online clickable",{active:w.value==="online"}]),onClick:e[1]||(e[1]=l=>se("online")),title:"Clique para filtrar"},[e[44]||(e[44]=t("span",{class:"stat-dot"},null,-1)),t("span",null,v(Ee.value)+" online",1)],2),t("div",{class:b(["stat-badge offline clickable",{active:w.value==="offline"}]),onClick:e[2]||(e[2]=l=>se("offline")),title:"Clique para filtrar"},[e[45]||(e[45]=t("span",{class:"stat-dot"},null,-1)),t("span",null,v(Se.value)+" offline",1)],2)]),t("button",{onClick:wt,class:"btn btn-secondary",disabled:x.value.size===0},[...e[46]||(e[46]=[t("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"})],-1),h(" Ver Todos ",-1)])],8,is),t("button",{onClick:ct,class:b(["btn",B.value?"btn-primary":"btn-secondary"])},[e[47]||(e[47]=t("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})],-1)),h(" "+v(B.value?"Sair Timeline":"Timeline"),1)],2),B.value?f("",!0):(c(),r("button",{key:0,onClick:ne,class:"btn btn-primary"},[...e[48]||(e[48]=[t("svg",{class:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"23 4 23 10 17 10"}),t("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})],-1),h(" Atualizar ",-1)])]))])]),t("div",rs,[!ke.value&&!pe.value?(c(),r("div",cs,[t("button",{class:b(["toggle-btn",{active:D.value==="all"}]),onClick:e[3]||(e[3]=l=>{D.value="all",H()})},[...e[50]||(e[50]=[Ze('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" data-v-80057a48><rect x="3" y="3" width="18" height="18" rx="2" data-v-80057a48></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-80057a48></circle><circle cx="15.5" cy="8.5" r="1.5" data-v-80057a48></circle><circle cx="8.5" cy="15.5" r="1.5" data-v-80057a48></circle><circle cx="15.5" cy="15.5" r="1.5" data-v-80057a48></circle></svg> Todos ',2)])],2),t("button",{class:b(["toggle-btn",{active:D.value==="applicators"}]),onClick:e[4]||(e[4]=l=>{D.value="applicators",H()})},[...e[51]||(e[51]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[t("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t("circle",{cx:"12",cy:"7",r:"4"})],-1),h(" Aplicadores ",-1)])],2),t("button",{class:b(["toggle-btn",{active:D.value==="projects"}]),onClick:e[5]||(e[5]=l=>{D.value="projects",H()})},[...e[52]||(e[52]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[t("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),t("circle",{cx:"12",cy:"10",r:"3"})],-1),h(" Projetos ",-1)])],2)])):f("",!0),ke.value?(c(),r("div",us,[...e[53]||(e[53]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Carregando mapa...",-1)])])):pe.value?(c(),r("div",ds,[e[54]||(e[54]=t("svg",{class:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),t("p",null,v(pe.value),1),I(Ge)?f("",!0):(c(),r("p",ps," Adicione VITE_GOOGLE_MAPS_API_KEY no arquivo .env "))])):f("",!0),t("div",{ref_key:"mapContainer",ref:we,class:"map"},null,512),ve.value?(c(),r("div",vs," Atualizado: "+v(ve.value.toLocaleTimeString("pt-BR")),1)):f("",!0)]),B.value?(c(),r("div",gs,[e[59]||(e[59]=Ze('<div class="sidebar-header" data-v-80057a48><div class="sidebar-title" data-v-80057a48><svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20" data-v-80057a48><circle cx="12" cy="12" r="10" data-v-80057a48></circle><polyline points="12 6 12 12 16 14" data-v-80057a48></polyline></svg><span data-v-80057a48>Timeline</span></div></div>',1)),t("div",fs,[e[55]||(e[55]=t("label",null,"Data",-1)),re(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=l=>ce.value=l),class:"date-input"},null,512),[[he,ce.value]])]),t("div",hs,[e[58]||(e[58]=t("div",{class:"list-header"},"Selecione um aplicador",-1)),t("div",ms,[e[57]||(e[57]=t("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"M21 21l-4.35-4.35"})],-1)),re(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=l=>Z.value=l),placeholder:"Buscar aplicador...",class:"timeline-search-input"},null,512),[[he,Z.value]]),Z.value?(c(),r("button",{key:0,class:"clear-search-btn",onClick:e[8]||(e[8]=l=>Z.value="")},[...e[56]||(e[56]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"14",height:"14"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])):f("",!0)]),Re.value.length===0?(c(),r("div",ys,v(Z.value?"Nenhum resultado encontrado":"Nenhum aplicador encontrado"),1)):f("",!0),(c(!0),r(ze,null,Oe(Re.value,l=>(c(),r("div",{key:l.id,class:b(["timeline-applicator-item",{selected:E.value?.id===l.id,online:l.isOnline}]),onClick:n=>ut(l)},[t("div",bs,[j(l.photoUrl)?(c(),r("img",{key:0,src:j(l.photoUrl),alt:l.name,class:"avatar-img"},null,8,ws)):(c(),r("span",ks,v(de(l.name)),1)),l.isOnline?(c(),r("span",Cs)):f("",!0)]),t("div",Ms,[t("span",$s,v(l.name),1),t("span",{class:b(["applicator-status",{online:l.isOnline}])},v(l.isOnline?"Online":"Offline"),3)])],10,xs))),128))])])):f("",!0),B.value&&E.value?(c(),r("div",As,[t("div",_s,[t("div",Ds,[j(E.value.photoUrl)?(c(),r("img",{key:0,src:j(E.value.photoUrl),alt:E.value.name,class:"user-avatar-small"},null,8,Ts)):(c(),r("span",Es,v(de(E.value.name)),1)),t("span",Ss,v(E.value.name),1)]),t("div",Ps,[e[60]||(e[60]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"16",height:"16"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})],-1)),t("span",null,v(lt.value),1)]),k.value?(c(),r("div",Is,v(k.value.points?.length||0)+" pontos ",1)):f("",!0)]),!k.value||!k.value.points?.length?(c(),r("div",Ls,[...e[61]||(e[61]=[t("span",null,"Sem registros de localiza√ß√£o para esta data",-1)])])):f("",!0),k.value&&k.value.points?.length>0?(c(),r("div",Bs,[t("span",zs,v(je(te.value)),1),re(t("input",{type:"range","onUpdate:modelValue":e[9]||(e[9]=l=>ee.value=l),min:te.value,max:ue.value,class:"timeline-slider",onInput:Fe},null,40,Os),[[he,ee.value,void 0,{number:!0}]]),t("span",Us,v(je(ue.value)),1)])):f("",!0),ye.value?(c(),r("div",js,[...e[62]||(e[62]=[t("div",{class:"mini-spinner"},null,-1),t("span",null,"Carregando...",-1)])])):f("",!0)])):f("",!0),(x.value.size>0||F.value.length>0)&&!B.value?(c(),r("div",{key:2,class:b(["applicators-sidebar",{collapsed:W.value}])},[t("div",Rs,[W.value?f("",!0):(c(),r("div",Vs,[t("span",null,v(z.value==="equipe"?"Equipe em Campo":"Projetos"),1)])),t("button",{class:"sidebar-collapse-btn",onClick:e[10]||(e[10]=l=>W.value=!W.value),title:W.value?"Expandir":"Recolher"},[(c(),r("svg",Fs,[W.value?(c(),r("polyline",qs)):(c(),r("polyline",Ws))]))],8,Ns)]),re(t("div",Hs,[t("div",Gs,[t("button",{class:b(["sidebar-toggle-btn",{active:z.value==="equipe"}]),onClick:e[11]||(e[11]=l=>{z.value="equipe",S.value="",w.value="all"})},[e[63]||(e[63]=t("img",{src:Rt,alt:"Equipe",style:{width:"20px",height:"20px","object-fit":"contain"}},null,-1)),e[64]||(e[64]=t("span",null,"Equipe",-1)),t("span",Ks,v(x.value.size),1)],2),t("button",{class:b(["sidebar-toggle-btn",{active:z.value==="projetos"}]),onClick:e[12]||(e[12]=l=>{z.value="projetos",S.value="",w.value="all"})},[e[65]||(e[65]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"18",height:"18"},[t("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),t("circle",{cx:"12",cy:"10",r:"3"})],-1)),e[66]||(e[66]=t("span",null,"Projetos",-1)),t("span",Ys,v(F.value.length),1)],2)]),t("div",Zs,[e[68]||(e[68]=t("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1)),re(t("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=l=>S.value=l),onInput:H,placeholder:z.value==="equipe"?"Buscar por nome...":"Buscar projeto...",class:"sidebar-search-input"},null,40,Qs),[[he,S.value]]),S.value?(c(),r("button",{key:0,onClick:e[14]||(e[14]=l=>{S.value="",H()}),class:"search-clear"},[...e[67]||(e[67]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"14",height:"14"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):f("",!0)]),z.value==="equipe"?(c(),r("div",Xs,[t("button",{class:b(["status-pill em-campo",{active:w.value==="emCampo"}]),onClick:e[15]||(e[15]=l=>se("emCampo"))},[e[69]||(e[69]=t("span",{class:"status-dot"},null,-1)),h(" "+v(Te.value),1)],2),t("button",{class:b(["status-pill online",{active:w.value==="online"}]),onClick:e[16]||(e[16]=l=>se("online"))},[e[70]||(e[70]=t("span",{class:"status-dot"},null,-1)),h(" "+v(Ee.value),1)],2),t("button",{class:b(["status-pill offline",{active:w.value==="offline"}]),onClick:e[17]||(e[17]=l=>se("offline"))},[e[71]||(e[71]=t("span",{class:"status-dot"},null,-1)),h(" "+v(Se.value),1)],2)])):f("",!0),z.value==="projetos"&&S.value?(c(),r("div",Js,[t("span",null,v(Pe.value.length)+" de "+v(F.value.length)+" projetos",1)])):f("",!0),z.value==="equipe"?(c(),r("div",el,[He.value.length===0?(c(),r("div",tl,[...e[72]||(e[72]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1),t("span",null,"Nenhum resultado encontrado",-1)])])):f("",!0),(c(!0),r(ze,null,Oe(He.value,([l,n])=>(c(),r("div",{key:l,class:b(["applicator-item",{online:n.userData?.isOnline,[V(n.userData?.user?.role||"",n.userData?.user?.name||"")]:!0}]),onClick:p=>xt(l)},[t("div",{class:b(["character-avatar",[{online:n.userData?.isOnline||n.userData?.hasActiveCheckin,offline:!n.userData?.isOnline&&!n.userData?.hasActiveCheckin},V(n.userData?.user?.role||"",n.userData?.user?.name||"")]])},[t("img",{src:K[V(n.userData?.user?.role||"")].icon,alt:K[V(n.userData?.user?.role||"")].label,class:b(["avatar-icon",{offline:!n.userData?.isOnline&&!n.userData?.hasActiveCheckin}])},null,10,ll),n.userData?.hasActiveCheckin?(c(),r("span",ol)):n.userData?.isOnline?(c(),r("span",al)):f("",!0)],2),t("div",nl,[t("div",il,[t("span",rl,v(n.userData?.user?.name),1),n.userData?.batteryLevel!==null&&n.userData?.batteryLevel!==void 0?(c(),r("span",{key:0,class:"battery-indicator",style:Et({color:ft(n.userData?.batteryLevel)}),title:`Bateria: ${n.userData?.batteryLevel}%${n.userData?.isCharging?" (carregando)":""}`},v(ht(n.userData?.batteryLevel,n.userData?.isCharging))+" "+v(n.userData?.batteryLevel)+"% ",13,cl)):f("",!0)]),t("span",{class:b(["applicator-role",V(n.userData?.user?.role||"",n.userData?.user?.name||"")])},v(K[V(n.userData?.user?.role||"")].label),3),t("div",ul,[t("span",dl,v(n.userData?.project?.title||"Sem projeto"),1),n.userData?.isOutOfArea?(c(),r("span",pl," FORA DA √ÅREA ")):f("",!0)])]),e[73]||(e[73]=t("div",{class:"applicator-arrow"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))],10,sl))),128))])):f("",!0),z.value==="projetos"?(c(),r("div",vl,[Pe.value.length===0?(c(),r("div",gl,[...e[74]||(e[74]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",width:"24",height:"24"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"m21 21-4.35-4.35"})],-1),t("span",null,"Nenhum projeto encontrado",-1)])])):f("",!0),(c(!0),r(ze,null,Oe(Pe.value,l=>(c(),r("div",{key:l.id,class:b(["project-item",{"has-team":l.hasActiveCheckin}]),onClick:n=>bt(l)},[t("div",{class:b(["project-icon",{active:l.hasActiveCheckin}])},[e[75]||(e[75]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),t("circle",{cx:"12",cy:"10",r:"3"})],-1)),l.activeUsers?.length?(c(),r("span",hl,v(l.activeUsers.length),1)):f("",!0)],2),t("div",ml,[t("div",yl,v(l.title),1),l.cliente?(c(),r("div",xl,v(l.cliente),1)):f("",!0),t("div",bl,[t("span",{class:b(["project-status-badge",l.hasActiveCheckin?"active":"empty"])},v(l.hasActiveCheckin?`${l.activeUsers?.length||0} em campo`:"Sem equipe"),3)])]),e[76]||(e[76]=t("div",{class:"project-arrow"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))],10,fl))),128))])):f("",!0)],512),[[Tt,!W.value]])],2)):f("",!0)])])}}}),Al=Pt(wl,[["__scopeId","data-v-80057a48"]]);export{Al as default};
